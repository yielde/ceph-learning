
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Create a Ceph file system &#8212; Ceph Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/ceph.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="CephFS Administrative commands" href="../administration/" />
    <link rel="prev" title="Ceph File System" href="../" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../http-routingtable/" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../administration/" title="CephFS Administrative commands"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../" title="Ceph File System"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" accesskey="U">Ceph File System</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Create a Ceph file system</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div id="docubetter" align="right" style="padding: 15px; font-weight: bold;">
    <a href="https://pad.ceph.com/p/Report_Documentation_Bugs">Report a Documentation Bug</a>
  </div>

  
  <section id="create-a-ceph-file-system">
<h1>Create a Ceph file system<a class="headerlink" href="#create-a-ceph-file-system" title="Permalink to this heading">¶</a></h1>
<section id="creating-pools">
<h2>Creating pools<a class="headerlink" href="#creating-pools" title="Permalink to this heading">¶</a></h2>
<p>A Ceph file system requires at least two RADOS pools, one for data and one for metadata.
When configuring these pools, you might consider:</p>
<ul class="simple">
<li><p>Using a higher replication level for the metadata pool, as any data loss in
this pool can render the whole file system inaccessible.</p></li>
<li><p>Using lower-latency storage such as SSDs for the metadata pool, as this will
directly affect the observed latency of file system operations on clients.</p></li>
<li><p>The data pool used to create the file system is the “default” data pool and
the location for storing all inode backtrace information, used for hard link
management and disaster recovery. For this reason, all inodes created in
CephFS have at least one object in the default data pool. If erasure-coded
pools are planned for the file system, it is usually better to use a
replicated pool for the default data pool to improve small-object write and
read performance for updating backtraces. Separately, another erasure-coded
data pool can be added (see also <a class="reference internal" href="../../rados/operations/erasure-code/#ecpool"><span class="std std-ref">Erasure code</span></a>) that can be used on an entire
hierarchy of directories and files (see also <a class="reference internal" href="../file-layouts/#file-layouts"><span class="std std-ref">File layouts</span></a>).</p></li>
</ul>
<p>Refer to <a class="reference internal" href="../../rados/operations/pools/"><span class="doc">Pools</span></a> to learn more about managing pools.  For
example, to create two pools with default settings for use with a file system, you
might run the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ceph<span class="w"> </span>osd<span class="w"> </span>pool<span class="w"> </span>create<span class="w"> </span>cephfs_data
$<span class="w"> </span>ceph<span class="w"> </span>osd<span class="w"> </span>pool<span class="w"> </span>create<span class="w"> </span>cephfs_metadata
</pre></div>
</div>
<p>Generally, the metadata pool will have at most a few gigabytes of data. For
this reason, a smaller PG count is usually recommended. 64 or 128 is commonly
used in practice for large clusters.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The names of the file systems, metadata pools, and data pools can
only have characters in the set [a-zA-Z0-9_-.].</p>
</div>
</section>
<section id="creating-a-file-system">
<h2>Creating a file system<a class="headerlink" href="#creating-a-file-system" title="Permalink to this heading">¶</a></h2>
<p>Once the pools are created, you may enable the file system using the <code class="docutils literal notranslate"><span class="pre">fs</span> <span class="pre">new</span></code> command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ceph<span class="w"> </span>fs<span class="w"> </span>new<span class="w"> </span>&lt;fs_name&gt;<span class="w"> </span>&lt;metadata&gt;<span class="w"> </span>&lt;data&gt;
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ceph<span class="w"> </span>fs<span class="w"> </span>new<span class="w"> </span>cephfs<span class="w"> </span>cephfs_metadata<span class="w"> </span>cephfs_data
$<span class="w"> </span>ceph<span class="w"> </span>fs<span class="w"> </span>ls
name:<span class="w"> </span>cephfs,<span class="w"> </span>metadata<span class="w"> </span>pool:<span class="w"> </span>cephfs_metadata,<span class="w"> </span>data<span class="w"> </span>pools:<span class="w"> </span><span class="o">[</span>cephfs_data<span class="w"> </span><span class="o">]</span>
</pre></div>
</div>
<p>Once a file system has been created, your MDS(s) will be able to enter
an <em>active</em> state.  For example, in a single MDS system:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ceph<span class="w"> </span>mds<span class="w"> </span>stat
cephfs-1/1/1<span class="w"> </span>up<span class="w"> </span><span class="o">{</span><span class="nv">0</span><span class="o">=</span><span class="nv">a</span><span class="o">=</span>up:active<span class="o">}</span>
</pre></div>
</div>
<p>Once the file system is created and the MDS is active, you are ready to mount
the file system.  If you have created more than one file system, you will
choose which to use when mounting.</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="../../cephfs/mount-using-kernel-driver">Mount CephFS</a></p></li>
<li><p><a class="reference external" href="../../cephfs/mount-using-fuse">Mount CephFS as FUSE</a></p></li>
<li><p><a class="reference external" href="../../cephfs/ceph-dokan">Mount CephFS on Windows</a></p></li>
</ul>
</div></blockquote>
<p>If you have created more than one file system, and a client does not
specify a file system when mounting, you can control which file system
they will see by using the <cite>ceph fs set-default</cite> command.</p>
<section id="adding-a-data-pool-to-the-file-system">
<h3>Adding a Data Pool to the File System<a class="headerlink" href="#adding-a-data-pool-to-the-file-system" title="Permalink to this heading">¶</a></h3>
<p>See <a class="reference internal" href="../file-layouts/#adding-data-pool-to-file-system"><span class="std std-ref">Adding a data pool to the File System</span></a>.</p>
</section>
</section>
<section id="using-erasure-coded-pools-with-cephfs">
<h2>Using Erasure Coded pools with CephFS<a class="headerlink" href="#using-erasure-coded-pools-with-cephfs" title="Permalink to this heading">¶</a></h2>
<p>You may use Erasure Coded pools as CephFS data pools as long as they have overwrites enabled, which is done as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ceph<span class="w"> </span>osd<span class="w"> </span>pool<span class="w"> </span><span class="nb">set</span><span class="w"> </span>my_ec_pool<span class="w"> </span>allow_ec_overwrites<span class="w"> </span><span class="nb">true</span>
</pre></div>
</div>
<p>Note that EC overwrites are only supported when using OSDS with the BlueStore backend.</p>
<p>You may not use Erasure Coded pools as CephFS metadata pools, because CephFS metadata is stored using RADOS <em>OMAP</em> data structures, which EC pools cannot store.</p>
</section>
</section>



            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/intro/">Intro to Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">Installing Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephadm/">Cephadm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rados/">Ceph Storage Cluster</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Ceph File System</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../#getting-started-with-cephfs">Getting Started with CephFS</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../#administration">Administration</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#"> Create a CephFS file system</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-pools">Creating pools</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-file-system">Creating a file system</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#adding-a-data-pool-to-the-file-system">Adding a Data Pool to the File System</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#using-erasure-coded-pools-with-cephfs">Using Erasure Coded pools with CephFS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../administration/"> Administrative commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../multifs/"> Creating Multiple File Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../add-remove-mds/"> Provision/Add/Remove MDS(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standby/">Terminology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standby/#referring-to-mds-daemons">Referring to MDS daemons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standby/#managing-failover">Managing failover</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standby/#configuring-standby-replay">Configuring standby-replay</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standby/#configuring-mds-file-system-affinity">Configuring MDS file system affinity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cache-configuration/"> MDS Cache Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mds-config-ref/"> MDS Configuration Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../man/8/ceph-mds/"> Manual: ceph-mds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nfs/"> Export over NFS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../app-best-practices/"> Application best practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fs-volumes/"> FS volume and subvolumes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quota/"> CephFS Quotas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../health-messages/"> Health messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrading/">Upgrading the MDS Cluster</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrading/#upgrading-pre-firefly-file-systems-past-jewel">Upgrading pre-Firefly file systems past Jewel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cephfs-top/"> CephFS Top Utility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../snap-schedule/"> Scheduled Snapshots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cephfs-mirroring/"> CephFS Snapshot Mirroring</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../#mounting-cephfs">Mounting CephFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../#cephfs-concepts">CephFS Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../#troubleshooting-and-disaster-recovery">Troubleshooting and Disaster Recovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="../#developer-guides">Developer Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="../#additional-details">Additional Details</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../rbd/">Ceph Block Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../radosgw/">Ceph Object Gateway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mgr/">Ceph Manager Daemon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mgr/dashboard/">Ceph Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/developer_guide/">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/internals/">Ceph Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../governance/">Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../foundation/">Ceph Foundation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.ceph.com/en/latest/releases/general/">Ceph Releases (general)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.ceph.com/en/latest/releases/">Ceph Releases (index)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Glossary</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../http-routingtable/" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../administration/" title="CephFS Administrative commands"
             >next</a> |</li>
        <li class="right" >
          <a href="../" title="Ceph File System"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" >Ceph File System</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Create a Ceph file system</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Ceph authors and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).
    </div>
  </body>
</html>