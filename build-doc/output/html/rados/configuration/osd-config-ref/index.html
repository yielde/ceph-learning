
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>OSD Config Reference &#8212; Ceph Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/ceph.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="next" title="mClock Config Reference" href="../mclock-config-ref/" />
    <link rel="prev" title="Configuring Monitor/OSD Interaction" href="../mon-osd-interaction/" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../http-routingtable/" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../mclock-config-ref/" title="mClock Config Reference"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../mon-osd-interaction/" title="Configuring Monitor/OSD Interaction"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../" >Ceph Storage Cluster</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../" accesskey="U">Configuration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">OSD Config Reference</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div id="docubetter" align="right" style="padding: 15px; font-weight: bold;">
    <a href="https://pad.ceph.com/p/Report_Documentation_Bugs">Report a Documentation Bug</a>
  </div>

  
  <section id="osd-config-reference">
<h1>OSD Config Reference<a class="headerlink" href="#osd-config-reference" title="Permalink to this heading">¶</a></h1>
<p id="index-0">You can configure Ceph OSD Daemons in the Ceph configuration file (or in recent
releases, the central config store), but Ceph OSD
Daemons can use the default values and a very minimal configuration. A minimal
Ceph OSD Daemon configuration sets <code class="docutils literal notranslate"><span class="pre">osd</span> <span class="pre">journal</span> <span class="pre">size</span></code> (for Filestore), <code class="docutils literal notranslate"><span class="pre">host</span></code>,  and
uses default values for nearly everything else.</p>
<p>Ceph OSD Daemons are numerically identified in incremental fashion, beginning
with <code class="docutils literal notranslate"><span class="pre">0</span></code> using the following convention.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">osd</span><span class="mf">.0</span>
<span class="n">osd</span><span class="mf">.1</span>
<span class="n">osd</span><span class="mf">.2</span>
</pre></div>
</div>
<p>In a configuration file, you may specify settings for all Ceph OSD Daemons in
the cluster by adding configuration settings to the <code class="docutils literal notranslate"><span class="pre">[osd]</span></code> section of your
configuration file. To add settings directly to a specific Ceph OSD Daemon
(e.g., <code class="docutils literal notranslate"><span class="pre">host</span></code>), enter  it in an OSD-specific section of your configuration
file. For example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[osd]</span>
<span class="w">        </span><span class="na">osd_journal_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">5120</span>

<span class="k">[osd.0]</span>
<span class="w">        </span><span class="na">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">osd-host-a</span>

<span class="k">[osd.1]</span>
<span class="w">        </span><span class="na">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">osd-host-b</span>
</pre></div>
</div>
<section id="general-settings">
<span id="index-1"></span><h2>General Settings<a class="headerlink" href="#general-settings" title="Permalink to this heading">¶</a></h2>
<p>The following settings provide a Ceph OSD Daemon’s ID, and determine paths to
data and journals. Ceph deployment scripts typically generate the UUID
automatically.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>DO NOT</strong> change the default paths for data or journals, as it
makes it more problematic to troubleshoot Ceph later.</p>
</div>
<p>When using Filestore, the journal size should be at least twice the product of the expected drive
speed multiplied by <code class="docutils literal notranslate"><span class="pre">filestore_max_sync_interval</span></code>. However, the most common
practice is to partition the journal drive (often an SSD), and mount it such
that Ceph uses the entire partition for the journal.</p>
<p><code class="docutils literal notranslate"><span class="pre">osd_uuid</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The universally unique identifier (UUID) for the Ceph OSD Daemon.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>UUID</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>The UUID.</p>
</dd>
<dt class="field-even">Note</dt>
<dd class="field-even"><p>The <code class="docutils literal notranslate"><span class="pre">osd_uuid</span></code> applies to a single Ceph OSD Daemon. The <code class="docutils literal notranslate"><span class="pre">fsid</span></code>
applies to the entire cluster.</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The path to the OSDs data. You must create the directory when
deploying Ceph. You should mount a drive for OSD data at this
mount point. We do not recommend changing the default.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>String</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">/var/lib/ceph/osd/$cluster-$id</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_max_write_size</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum size of a write in megabytes.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">90</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_max_object_size</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum size of a RADOS object in bytes.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>128MB</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_client_message_size_cap</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The largest client data message allowed in memory.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>64-bit Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>500MB default. <code class="docutils literal notranslate"><span class="pre">500*1024L*1024L</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_class_dir</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The class path for RADOS class plug-ins.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>String</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">$libdir/rados-classes</span></code></p>
</dd>
</dl>
</section>
<section id="file-system-settings">
<span id="index-2"></span><h2>File System Settings<a class="headerlink" href="#file-system-settings" title="Permalink to this heading">¶</a></h2>
<p>Ceph builds and mounts file systems which are used for Ceph OSDs.</p>
<p><code class="docutils literal notranslate"><span class="pre">osd_mkfs_options</span> <span class="pre">{fs-type}</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Options used when creating a new Ceph Filestore OSD of type {fs-type}.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>String</p>
</dd>
<dt class="field-odd">Default for xfs</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-f</span> <span class="pre">-i</span> <span class="pre">2048</span></code></p>
</dd>
<dt class="field-even">Default for other file systems</dt>
<dd class="field-even"><p>{empty string}</p>
</dd>
</dl>
<dl class="simple">
<dt>For example::</dt><dd><p><code class="docutils literal notranslate"><span class="pre">osd_mkfs_options_xfs</span> <span class="pre">=</span> <span class="pre">-f</span> <span class="pre">-d</span> <span class="pre">agcount=24</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_mount_options</span> <span class="pre">{fs-type}</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Options used when mounting a Ceph Filestore OSD of type {fs-type}.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>String</p>
</dd>
<dt class="field-odd">Default for xfs</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">rw,noatime,inode64</span></code></p>
</dd>
<dt class="field-even">Default for other file systems</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">rw,</span> <span class="pre">noatime</span></code></p>
</dd>
</dl>
<dl class="simple">
<dt>For example::</dt><dd><p><code class="docutils literal notranslate"><span class="pre">osd_mount_options_xfs</span> <span class="pre">=</span> <span class="pre">rw,</span> <span class="pre">noatime,</span> <span class="pre">inode64,</span> <span class="pre">logbufs=8</span></code></p>
</dd>
</dl>
</section>
<section id="journal-settings">
<span id="index-3"></span><h2>Journal Settings<a class="headerlink" href="#journal-settings" title="Permalink to this heading">¶</a></h2>
<p>This section applies only to the older Filestore OSD back end.  Since Luminous
BlueStore has been default and preferred.</p>
<p>By default, Ceph expects that you will provision a Ceph OSD Daemon’s journal at
the following path, which is usually a symlink to a device or partition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/var/lib/ceph/osd/$cluster-$id/journal
</pre></div>
</div>
<p>When using a single device type (for example, spinning drives), the journals
should be <em>colocated</em>: the logical volume (or partition) should be in the same
device as the <code class="docutils literal notranslate"><span class="pre">data</span></code> logical volume.</p>
<p>When using a mix of fast (SSDs, NVMe) devices with slower ones (like spinning
drives) it makes sense to place the journal on the faster device, while
<code class="docutils literal notranslate"><span class="pre">data</span></code> occupies the slower device fully.</p>
<p>The default <code class="docutils literal notranslate"><span class="pre">osd_journal_size</span></code> value is 5120 (5 gigabytes), but it can be
larger, in which case it will need to be set in the <code class="docutils literal notranslate"><span class="pre">ceph.conf</span></code> file.
A value of 10 gigabytes is common in practice:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">osd_journal_size</span> <span class="o">=</span> <span class="mi">10240</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">osd_journal</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The path to the OSD’s journal. This may be a path to a file or a
block device (such as a partition of an SSD). If it is a file,
you must create the directory to contain it. We recommend using a
separate fast device when the <code class="docutils literal notranslate"><span class="pre">osd_data</span></code> drive is an HDD.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>String</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">/var/lib/ceph/osd/$cluster-$id/journal</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_journal_size</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The size of the journal in megabytes.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">5120</span></code></p>
</dd>
</dl>
<p>See <a class="reference external" href="../journal-ref">Journal Config Reference</a> for additional details.</p>
</section>
<section id="monitor-osd-interaction">
<h2>Monitor OSD Interaction<a class="headerlink" href="#monitor-osd-interaction" title="Permalink to this heading">¶</a></h2>
<p>Ceph OSD Daemons check each other’s heartbeats and report to monitors
periodically. Ceph can use default values in many cases. However, if your
network has latency issues, you may need to adopt longer intervals. See
<a class="reference external" href="../mon-osd-interaction">Configuring Monitor/OSD Interaction</a> for a detailed discussion of heartbeats.</p>
</section>
<section id="data-placement">
<h2>Data Placement<a class="headerlink" href="#data-placement" title="Permalink to this heading">¶</a></h2>
<p>See <a class="reference external" href="../pool-pg-config-ref">Pool &amp; PG Config Reference</a> for details.</p>
</section>
<section id="scrubbing">
<span id="rados-config-scrubbing"></span><span id="index-4"></span><h2>Scrubbing<a class="headerlink" href="#scrubbing" title="Permalink to this heading">¶</a></h2>
<p>In addition to making multiple copies of objects, Ceph ensures data integrity by
scrubbing placement groups. Ceph scrubbing is analogous to <code class="docutils literal notranslate"><span class="pre">fsck</span></code> on the
object storage layer. For each placement group, Ceph generates a catalog of all
objects and compares each primary object and its replicas to ensure that no
objects are missing or mismatched. Light scrubbing (daily) checks the object
size and attributes.  Deep scrubbing (weekly) reads the data and uses checksums
to ensure data integrity.</p>
<p>Scrubbing is important for maintaining data integrity, but it can reduce
performance. You can adjust the following settings to increase or decrease
scrubbing operations.</p>
<p><code class="docutils literal notranslate"><span class="pre">osd_max_scrubs</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum number of simultaneous scrub operations for
a Ceph OSD Daemon.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Int</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_begin_hour</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This restricts scrubbing to this hour of the day or later.
Use <code class="docutils literal notranslate"><span class="pre">osd_scrub_begin_hour</span> <span class="pre">=</span> <span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">osd_scrub_end_hour</span> <span class="pre">=</span> <span class="pre">0</span></code>
to allow scrubbing the entire day.  Along with <code class="docutils literal notranslate"><span class="pre">osd_scrub_end_hour</span></code>, they define a time
window, in which the scrubs can happen.
But a scrub will be performed
no matter whether the time window allows or not, as long as the placement
group’s scrub interval exceeds <code class="docutils literal notranslate"><span class="pre">osd_scrub_max_interval</span></code>.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Integer in the range of 0 to 23</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_end_hour</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This restricts scrubbing to the hour earlier than this.
Use <code class="docutils literal notranslate"><span class="pre">osd_scrub_begin_hour</span> <span class="pre">=</span> <span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">osd_scrub_end_hour</span> <span class="pre">=</span> <span class="pre">0</span></code> to allow scrubbing
for the entire day.  Along with <code class="docutils literal notranslate"><span class="pre">osd_scrub_begin_hour</span></code>, they define a time
window, in which the scrubs can happen. But a scrub will be performed
no matter whether the time window allows or not, as long as the placement
group’s scrub interval exceeds <code class="docutils literal notranslate"><span class="pre">osd_scrub_max_interval</span></code>.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Integer in the range of 0 to 23</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_begin_week_day</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This restricts scrubbing to this day of the week or later.
0  = Sunday, 1 = Monday, etc. Use <code class="docutils literal notranslate"><span class="pre">osd_scrub_begin_week_day</span> <span class="pre">=</span> <span class="pre">0</span></code>
and <code class="docutils literal notranslate"><span class="pre">osd_scrub_end_week_day</span> <span class="pre">=</span> <span class="pre">0</span></code> to allow scrubbing for the entire week.
Along with <code class="docutils literal notranslate"><span class="pre">osd_scrub_end_week_day</span></code>, they define a time window in which
scrubs can happen. But a scrub will be performed
no matter whether the time window allows or not, when the PG’s
scrub interval exceeds <code class="docutils literal notranslate"><span class="pre">osd_scrub_max_interval</span></code>.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Integer in the range of 0 to 6</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_end_week_day</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This restricts scrubbing to days of the week earlier than this.
0 = Sunday, 1 = Monday, etc.  Use <code class="docutils literal notranslate"><span class="pre">osd_scrub_begin_week_day</span> <span class="pre">=</span> <span class="pre">0</span></code>
and <code class="docutils literal notranslate"><span class="pre">osd_scrub_end_week_day</span> <span class="pre">=</span> <span class="pre">0</span></code> to allow scrubbing for the entire week.
Along with <code class="docutils literal notranslate"><span class="pre">osd_scrub_begin_week_day</span></code>, they define a time
window, in which the scrubs can happen. But a scrub will be performed
no matter whether the time window allows or not, as long as the placement
group’s scrub interval exceeds <code class="docutils literal notranslate"><span class="pre">osd_scrub_max_interval</span></code>.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Integer in the range of 0 to 6</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd</span> <span class="pre">scrub</span> <span class="pre">during</span> <span class="pre">recovery</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Allow scrub during recovery. Setting this to <code class="docutils literal notranslate"><span class="pre">false</span></code> will disable
scheduling new scrub (and deep–scrub) while there is active recovery.
Already running scrubs will be continued. This might be useful to reduce
load on busy clusters.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Boolean</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_thread_timeout</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum time in seconds before timing out a scrub thread.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">60</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_finalize_thread_timeout</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum time in seconds before timing out a scrub finalize
thread.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">10*60</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_load_threshold</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The normalized maximum load. Ceph will not scrub when the system load
(as defined by <code class="docutils literal notranslate"><span class="pre">getloadavg()</span> <span class="pre">/</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">online</span> <span class="pre">CPUs</span></code>) is higher than this number.
Default is <code class="docutils literal notranslate"><span class="pre">0.5</span></code>.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0.5</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_min_interval</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The minimal interval in seconds for scrubbing the Ceph OSD Daemon
when the Ceph Storage Cluster load is low.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>Once per day. <code class="docutils literal notranslate"><span class="pre">24*60*60</span></code></p>
</dd>
</dl>
<p id="osd-scrub-max-interval"><code class="docutils literal notranslate"><span class="pre">osd_scrub_max_interval</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum interval in seconds for scrubbing the Ceph OSD Daemon
irrespective of cluster load.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>Once per week. <code class="docutils literal notranslate"><span class="pre">7*24*60*60</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_chunk_min</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The minimal number of object store chunks to scrub during single operation.
Ceph blocks writes to single chunk during scrub.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>5</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_chunk_max</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum number of object store chunks to scrub during single operation.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>25</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_sleep</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Time to sleep before scrubbing the next group of chunks. Increasing this value will slow
down the overall rate of scrubbing so that client operations will be less impacted.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>0</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_deep_scrub_interval</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The interval for “deep” scrubbing (fully reading all data). The
<code class="docutils literal notranslate"><span class="pre">osd_scrub_load_threshold</span></code> does not affect this setting.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>Once per week.  <code class="docutils literal notranslate"><span class="pre">7*24*60*60</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_interval_randomize_ratio</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Add a random delay to <code class="docutils literal notranslate"><span class="pre">osd_scrub_min_interval</span></code> when scheduling
the next scrub job for a PG. The delay is a random
value less than <code class="docutils literal notranslate"><span class="pre">osd_scrub_min_interval</span></code> *
<code class="docutils literal notranslate"><span class="pre">osd_scrub_interval_randomized_ratio</span></code>. The default setting
spreads scrubs throughout the allowed time
window of <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">1.5]</span></code> * <code class="docutils literal notranslate"><span class="pre">osd_scrub_min_interval</span></code>.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0.5</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_deep_scrub_stride</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Read size when doing a deep scrub.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>512 KB. <code class="docutils literal notranslate"><span class="pre">524288</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_auto_repair</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Setting this to <code class="docutils literal notranslate"><span class="pre">true</span></code> will enable automatic PG repair when errors
are found by scrubs or deep-scrubs.  However, if more than
<code class="docutils literal notranslate"><span class="pre">osd_scrub_auto_repair_num_errors</span></code> errors are found a repair is NOT performed.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Boolean</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_auto_repair_num_errors</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Auto repair will not occur if more than this many errors are found.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p>
</dd>
</dl>
</section>
<section id="operations">
<span id="index-5"></span><h2>Operations<a class="headerlink" href="#operations" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">osd_op_queue</span></code></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This sets the type of queue to be used for prioritizing ops
within each OSD. Both queues feature a strict sub-queue which is
dequeued before the normal queue. The normal queue is different
between implementations. The WeightedPriorityQueue (<code class="docutils literal notranslate"><span class="pre">wpq</span></code>)
dequeues operations in relation to their priorities to prevent
starvation of any queue. WPQ should help in cases where a few OSDs
are more overloaded than others. The new mClockQueue
(<code class="docutils literal notranslate"><span class="pre">mclock_scheduler</span></code>) prioritizes operations based on which class
they belong to (recovery, scrub, snaptrim, client op, osd subop).
See <a class="reference internal" href="#qos-based-on-mclock">QoS Based on mClock</a>. Requires a restart.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>String</p>
</dd>
<dt class="field-odd">Valid Choices</dt>
<dd class="field-odd"><p>wpq, mclock_scheduler</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">wpq</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_op_queue_cut_off</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This selects which priority ops will be sent to the strict
queue verses the normal queue. The <code class="docutils literal notranslate"><span class="pre">low</span></code> setting sends all
replication ops and higher to the strict queue, while the <code class="docutils literal notranslate"><span class="pre">high</span></code>
option sends only replication acknowledgment ops and higher to
the strict queue. Setting this to <code class="docutils literal notranslate"><span class="pre">high</span></code> should help when a few
OSDs in the cluster are very busy especially when combined with
<code class="docutils literal notranslate"><span class="pre">wpq</span></code> in the <code class="docutils literal notranslate"><span class="pre">osd_op_queue</span></code> setting. OSDs that are very busy
handling replication traffic could starve primary client traffic
on these OSDs without these settings. Requires a restart.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>String</p>
</dd>
<dt class="field-odd">Valid Choices</dt>
<dd class="field-odd"><p>low, high</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">high</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_client_op_priority</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The priority set for client operations.  This value is relative
to that of <code class="docutils literal notranslate"><span class="pre">osd_recovery_op_priority</span></code> below.  The default
strongly favors client ops over recovery.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">63</span></code></p>
</dd>
<dt class="field-even">Valid Range</dt>
<dd class="field-even"><p>1-63</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_recovery_op_priority</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The priority of recovery operations vs client operations, if not specified by the
pool’s <code class="docutils literal notranslate"><span class="pre">recovery_op_priority</span></code>.  The default value prioritizes client
ops (see above) over recovery ops.  You may adjust the tradeoff of client
impact against the time to restore cluster health by lowering this value
for increased prioritization of client ops, or by increasing it to favor
recovery.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">3</span></code></p>
</dd>
<dt class="field-even">Valid Range</dt>
<dd class="field-even"><p>1-63</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_scrub_priority</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The default work queue priority for scheduled scrubs when the
pool doesn’t specify a value of <code class="docutils literal notranslate"><span class="pre">scrub_priority</span></code>.  This can be
boosted to the value of <code class="docutils literal notranslate"><span class="pre">osd_client_op_priority</span></code> when scrubs are
blocking client operations.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p>
</dd>
<dt class="field-even">Valid Range</dt>
<dd class="field-even"><p>1-63</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_requested_scrub_priority</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The priority set for user requested scrub on the work queue.  If
this value were to be smaller than <code class="docutils literal notranslate"><span class="pre">osd_client_op_priority</span></code> it
can be boosted to the value of <code class="docutils literal notranslate"><span class="pre">osd_client_op_priority</span></code> when
scrub is blocking client operations.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">120</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_snap_trim_priority</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The priority set for the snap trim work queue.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p>
</dd>
<dt class="field-even">Valid Range</dt>
<dd class="field-even"><p>1-63</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_snap_trim_sleep</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Time in seconds to sleep before next snap trim op.
Increasing this value will slow down snap trimming.
This option overrides backend specific variants.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_snap_trim_sleep_hdd</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Time in seconds to sleep before next snap trim op
for HDDs.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_snap_trim_sleep_ssd</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Time in seconds to sleep before next snap trim op
for SSD OSDs (including NVMe).</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_snap_trim_sleep_hybrid</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Time in seconds to sleep before next snap trim op
when OSD data is on an HDD and the OSD journal or WAL+DB is on an SSD.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_op_thread_timeout</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The Ceph OSD Daemon operation thread timeout in seconds.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">15</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_op_complaint_time</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>An operation becomes complaint worthy after the specified number
of seconds have elapsed.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">30</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_op_history_size</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum number of completed operations to track.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">20</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_op_history_duration</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The oldest completed operation to track.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">600</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_op_log_threshold</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>How many operations logs to display at once.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p>
</dd>
</dl>
<section id="qos-based-on-mclock">
<span id="dmclock-qos"></span><h3>QoS Based on mClock<a class="headerlink" href="#qos-based-on-mclock" title="Permalink to this heading">¶</a></h3>
<p>Ceph’s use of mClock is now more refined and can be used by following the
steps as described in <a class="reference external" href="../mclock-config-ref">mClock Config Reference</a>.</p>
<section id="core-concepts">
<h4>Core Concepts<a class="headerlink" href="#core-concepts" title="Permalink to this heading">¶</a></h4>
<p>Ceph’s QoS support is implemented using a queueing scheduler
based on <a class="reference external" href="https://www.usenix.org/legacy/event/osdi10/tech/full_papers/Gulati.pdf">the dmClock algorithm</a>. This algorithm allocates the I/O
resources of the Ceph cluster in proportion to weights, and enforces
the constraints of minimum reservation and maximum limitation, so that
the services can compete for the resources fairly. Currently the
<em>mclock_scheduler</em> operation queue divides Ceph services involving I/O
resources into following buckets:</p>
<ul class="simple">
<li><p>client op: the iops issued by client</p></li>
<li><p>osd subop: the iops issued by primary OSD</p></li>
<li><p>snap trim: the snap trimming related requests</p></li>
<li><p>pg recovery: the recovery related requests</p></li>
<li><p>pg scrub: the scrub related requests</p></li>
</ul>
<p>And the resources are partitioned using following three sets of tags. In other
words, the share of each type of service is controlled by three tags:</p>
<ol class="arabic simple">
<li><p>reservation: the minimum IOPS allocated for the service.</p></li>
<li><p>limitation: the maximum IOPS allocated for the service.</p></li>
<li><p>weight: the proportional share of capacity if extra capacity or system
oversubscribed.</p></li>
</ol>
<p>In Ceph, operations are graded with “cost”. And the resources allocated
for serving various services are consumed by these “costs”. So, for
example, the more reservation a services has, the more resource it is
guaranteed to possess, as long as it requires. Assuming there are 2
services: recovery and client ops:</p>
<ul class="simple">
<li><p>recovery: (r:1, l:5, w:1)</p></li>
<li><p>client ops: (r:2, l:0, w:9)</p></li>
</ul>
<p>The settings above ensure that the recovery won’t get more than 5
requests per second serviced, even if it requires so (see CURRENT
IMPLEMENTATION NOTE below), and no other services are competing with
it. But if the clients start to issue large amount of I/O requests,
neither will they exhaust all the I/O resources. 1 request per second
is always allocated for recovery jobs as long as there are any such
requests. So the recovery jobs won’t be starved even in a cluster with
high load. And in the meantime, the client ops can enjoy a larger
portion of the I/O resource, because its weight is “9”, while its
competitor “1”. In the case of client ops, it is not clamped by the
limit setting, so it can make use of all the resources if there is no
recovery ongoing.</p>
<p>CURRENT IMPLEMENTATION NOTE: the current implementation enforces the limit
values. Therefore, if a service crosses the enforced limit, the op remains
in the operation queue until the limit is restored.</p>
</section>
<section id="subtleties-of-mclock">
<h4>Subtleties of mClock<a class="headerlink" href="#subtleties-of-mclock" title="Permalink to this heading">¶</a></h4>
<p>The reservation and limit values have a unit of requests per
second. The weight, however, does not technically have a unit and the
weights are relative to one another. So if one class of requests has a
weight of 1 and another a weight of 9, then the latter class of
requests should get 9 executed at a 9 to 1 ratio as the first class.
However that will only happen once the reservations are met and those
values include the operations executed under the reservation phase.</p>
<p>Even though the weights do not have units, one must be careful in
choosing their values due how the algorithm assigns weight tags to
requests. If the weight is <em>W</em>, then for a given class of requests,
the next one that comes in will have a weight tag of <em>1/W</em> plus the
previous weight tag or the current time, whichever is larger. That
means if <em>W</em> is sufficiently large and therefore <em>1/W</em> is sufficiently
small, the calculated tag may never be assigned as it will get a value
of the current time. The ultimate lesson is that values for weight
should not be too large. They should be under the number of requests
one expects to be serviced each second.</p>
</section>
<section id="caveats">
<h4>Caveats<a class="headerlink" href="#caveats" title="Permalink to this heading">¶</a></h4>
<p>There are some factors that can reduce the impact of the mClock op
queues within Ceph. First, requests to an OSD are sharded by their
placement group identifier. Each shard has its own mClock queue and
these queues neither interact nor share information among them. The
number of shards can be controlled with the configuration options
<code class="docutils literal notranslate"><span class="pre">osd_op_num_shards</span></code>, <code class="docutils literal notranslate"><span class="pre">osd_op_num_shards_hdd</span></code>, and
<code class="docutils literal notranslate"><span class="pre">osd_op_num_shards_ssd</span></code>. A lower number of shards will increase the
impact of the mClock queues, but may have other deleterious effects.</p>
<p>Second, requests are transferred from the operation queue to the
operation sequencer, in which they go through the phases of
execution. The operation queue is where mClock resides and mClock
determines the next op to transfer to the operation sequencer. The
number of operations allowed in the operation sequencer is a complex
issue. In general we want to keep enough operations in the sequencer
so it’s always getting work done on some operations while it’s waiting
for disk and network access to complete on other operations. On the
other hand, once an operation is transferred to the operation
sequencer, mClock no longer has control over it. Therefore to maximize
the impact of mClock, we want to keep as few operations in the
operation sequencer as possible. So we have an inherent tension.</p>
<p>The configuration options that influence the number of operations in
the operation sequencer are <code class="docutils literal notranslate"><span class="pre">bluestore_throttle_bytes</span></code>,
<code class="docutils literal notranslate"><span class="pre">bluestore_throttle_deferred_bytes</span></code>,
<code class="docutils literal notranslate"><span class="pre">bluestore_throttle_cost_per_io</span></code>,
<code class="docutils literal notranslate"><span class="pre">bluestore_throttle_cost_per_io_hdd</span></code>, and
<code class="docutils literal notranslate"><span class="pre">bluestore_throttle_cost_per_io_ssd</span></code>.</p>
<p>A third factor that affects the impact of the mClock algorithm is that
we’re using a distributed system, where requests are made to multiple
OSDs and each OSD has (can have) multiple shards. Yet we’re currently
using the mClock algorithm, which is not distributed (note: dmClock is
the distributed version of mClock).</p>
<p>Various organizations and individuals are currently experimenting with
mClock as it exists in this code base along with their modifications
to the code base. We hope you’ll share you’re experiences with your
mClock and dmClock experiments on the <code class="docutils literal notranslate"><span class="pre">ceph-devel</span></code> mailing list.</p>
<p><code class="docutils literal notranslate"><span class="pre">osd_push_per_object_cost</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>the overhead for serving a push op</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1000</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_recovery_max_chunk</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>the maximum total size of data chunks a recovery op can carry.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>8 MiB</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_mclock_scheduler_client_res</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>IO proportion reserved for each client (default).</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_mclock_scheduler_client_wgt</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>IO share for each client (default) over reservation.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_mclock_scheduler_client_lim</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>IO limit for each client (default) over reservation.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>999999</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_mclock_scheduler_background_recovery_res</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>IO proportion reserved for background recovery (default).</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_mclock_scheduler_background_recovery_wgt</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>IO share for each background recovery over reservation.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_mclock_scheduler_background_recovery_lim</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>IO limit for background recovery over reservation.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>999999</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_mclock_scheduler_background_best_effort_res</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>IO proportion reserved for background best_effort (default).</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_mclock_scheduler_background_best_effort_wgt</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>IO share for each background best_effort over reservation.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_mclock_scheduler_background_best_effort_lim</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>IO limit for background best_effort over reservation.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>999999</p>
</dd>
</dl>
</section>
</section>
</section>
<section id="backfilling">
<span id="index-6"></span><h2>Backfilling<a class="headerlink" href="#backfilling" title="Permalink to this heading">¶</a></h2>
<p>When you add or remove Ceph OSD Daemons to a cluster, CRUSH will
rebalance the cluster by moving placement groups to or from Ceph OSDs
to restore balanced utilization. The process of migrating placement groups and
the objects they contain can reduce the cluster’s operational performance
considerably. To maintain operational performance, Ceph performs this migration
with ‘backfilling’, which allows Ceph to set backfill operations to a lower
priority than requests to read or write data.</p>
<p><code class="docutils literal notranslate"><span class="pre">osd_max_backfills</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum number of backfills allowed to or from a single OSD.
Note that this is applied separately for read and write operations.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>64-bit Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_backfill_scan_min</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The minimum number of objects per backfill scan.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">64</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_backfill_scan_max</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum number of objects per backfill scan.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">512</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_backfill_retry_interval</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The number of seconds to wait before retrying backfill requests.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Double</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">10.0</span></code></p>
</dd>
</dl>
</section>
<section id="osd-map">
<span id="index-7"></span><h2>OSD Map<a class="headerlink" href="#osd-map" title="Permalink to this heading">¶</a></h2>
<p>OSD maps reflect the OSD daemons operating in the cluster. Over time, the
number of map epochs increases. Ceph provides some settings to ensure that
Ceph performs well as the OSD map grows larger.</p>
<p><code class="docutils literal notranslate"><span class="pre">osd_map_dedup</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Enable removing duplicates in the OSD map.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Boolean</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_map_cache_size</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The number of OSD maps to keep cached.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">50</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_map_message_max</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum map entries allowed per MOSDMap message.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">40</span></code></p>
</dd>
</dl>
</section>
<section id="recovery">
<span id="index-8"></span><h2>Recovery<a class="headerlink" href="#recovery" title="Permalink to this heading">¶</a></h2>
<p>When the cluster starts or when a Ceph OSD Daemon crashes and restarts, the OSD
begins peering with other Ceph OSD Daemons before writes can occur.  See
<a class="reference external" href="../../operations/monitoring-osd-pg#peering">Monitoring OSDs and PGs</a> for details.</p>
<p>If a Ceph OSD Daemon crashes and comes back online, usually it will be out of
sync with other Ceph OSD Daemons containing more recent versions of objects in
the placement groups. When this happens, the Ceph OSD Daemon goes into recovery
mode and seeks to get the latest copy of the data and bring its map back up to
date. Depending upon how long the Ceph OSD Daemon was down, the OSD’s objects
and placement groups may be significantly out of date. Also, if a failure domain
went down (e.g., a rack), more than one Ceph OSD Daemon may come back online at
the same time. This can make the recovery process time consuming and resource
intensive.</p>
<p>To maintain operational performance, Ceph performs recovery with limitations on
the number recovery requests, threads and object chunk sizes which allows Ceph
perform well in a degraded state.</p>
<p><code class="docutils literal notranslate"><span class="pre">osd_recovery_delay_start</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>After peering completes, Ceph will delay for the specified number
of seconds before starting to recover RADOS objects.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_recovery_max_active</span></code></p>
<dl class="field-list">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The number of active recovery requests per OSD at one time. More
requests will accelerate recovery, but the requests places an
increased load on the cluster.</p>
<p>This value is only used if it is non-zero. Normally it
is <code class="docutils literal notranslate"><span class="pre">0</span></code>, which means that the <code class="docutils literal notranslate"><span class="pre">hdd</span></code> or <code class="docutils literal notranslate"><span class="pre">ssd</span></code> values
(below) are used, depending on the type of the primary
device backing the OSD.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_recovery_max_active_hdd</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The number of active recovery requests per OSD at one time, if the
primary device is rotational.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">3</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_recovery_max_active_ssd</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The number of active recovery requests per OSD at one time, if the
primary device is non-rotational (i.e., an SSD).</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">10</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_recovery_max_chunk</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum size of a recovered chunk of data to push.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>64-bit Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">8</span> <span class="pre">&lt;&lt;</span> <span class="pre">20</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_recovery_max_single_start</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum number of recovery operations per OSD that will be
newly started when an OSD is recovering.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>64-bit Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_recovery_thread_timeout</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum time in seconds before timing out a recovery thread.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">30</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_recover_clone_overlap</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Preserves clone overlap during recovery. Should always be set
to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Boolean</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_recovery_sleep</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Time in seconds to sleep before the next recovery or backfill op.
Increasing this value will slow down recovery operation while
client operations will be less impacted.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_recovery_sleep_hdd</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Time in seconds to sleep before next recovery or backfill op
for HDDs.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0.1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_recovery_sleep_ssd</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Time in seconds to sleep before the next recovery or backfill op
for SSDs.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_recovery_sleep_hybrid</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Time in seconds to sleep before the next recovery or backfill op
when OSD data is on HDD and OSD journal / WAL+DB is on SSD.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0.025</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_recovery_priority</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The default priority set for recovery work queue.  Not
related to a pool’s <code class="docutils literal notranslate"><span class="pre">recovery_priority</span></code>.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p>
</dd>
</dl>
</section>
<section id="tiering">
<h2>Tiering<a class="headerlink" href="#tiering" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">osd_agent_max_ops</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum number of simultaneous flushing ops per tiering agent
in the high speed mode.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_agent_max_low_ops</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum number of simultaneous flushing ops per tiering agent
in the low speed mode.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p>
</dd>
</dl>
<p>See <a class="reference external" href="../../operations/pools#cache-target-dirty-high-ratio">cache target dirty high ratio</a> for when the tiering agent flushes dirty
objects within the high speed mode.</p>
</section>
<section id="miscellaneous">
<h2>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">osd_snap_trim_thread_timeout</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum time in seconds before timing out a snap trim thread.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">1*60*60</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_backlog_thread_timeout</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum time in seconds before timing out a backlog thread.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">1*60*60</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_default_notify_timeout</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The OSD default notification timeout (in seconds).</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Unsigned Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">30</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_check_for_log_corruption</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Check log files for corruption. Can be computationally expensive.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Boolean</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_remove_thread_timeout</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum time in seconds before timing out a remove OSD thread.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">60*60</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_command_thread_timeout</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The maximum time in seconds before timing out a command thread.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">10*60</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_delete_sleep</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Time in seconds to sleep before the next removal transaction. This
throttles the PG deletion process.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_delete_sleep_hdd</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Time in seconds to sleep before the next removal transaction
for HDDs.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">5</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_delete_sleep_ssd</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Time in seconds to sleep before the next removal transaction
for SSDs.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_delete_sleep_hybrid</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Time in seconds to sleep before the next removal transaction
when OSD data is on HDD and OSD journal or WAL+DB is on SSD.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_command_max_records</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Limits the number of lost objects to return.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>32-bit Integer</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">256</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">osd_fast_fail_on_connection_refused</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>If this option is enabled, crashed OSDs are marked down
immediately by connected peers and MONs (assuming that the
crashed OSD host survives). Disable it to restore old
behavior, at the expense of possible long I/O stalls when
OSDs crash in the middle of I/O operations.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Boolean</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p>
</dd>
</dl>
</section>
</section>



            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../">
              <img class="logo" src="../../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../start/intro/">Intro to Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/">Installing Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cephadm/">Cephadm</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../">Ceph Storage Cluster</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../">Configuration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../storage-devices/">Storage devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-conf/">Configuring Ceph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../common/">Common Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../common/#networks">Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../common/#monitors">Monitors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../common/#authentication">Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../common/#osds">OSDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../common/#heartbeats">Heartbeats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../common/#logs-debugging">Logs / Debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../common/#example-ceph-conf">Example ceph.conf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../common/#running-multiple-clusters-deprecated">Running Multiple Clusters (DEPRECATED)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../network-config-ref/">Network Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../msgr2/">Messenger v2 protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auth-config-ref/">Auth Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mon-config-ref/">Monitor Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mon-lookup-dns/">Looking up Monitors through DNS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mon-osd-interaction/">Heartbeat Settings</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">OSD Settings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#general-settings">General Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#file-system-settings">File System Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#journal-settings">Journal Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#monitor-osd-interaction">Monitor OSD Interaction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-placement">Data Placement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scrubbing">Scrubbing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#operations">Operations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#qos-based-on-mclock">QoS Based on mClock</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#core-concepts">Core Concepts</a></li>
<li class="toctree-l6"><a class="reference internal" href="#subtleties-of-mclock">Subtleties of mClock</a></li>
<li class="toctree-l6"><a class="reference internal" href="#caveats">Caveats</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#backfilling">Backfilling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#osd-map">OSD Map</a></li>
<li class="toctree-l4"><a class="reference internal" href="#recovery">Recovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tiering">Tiering</a></li>
<li class="toctree-l4"><a class="reference internal" href="#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../mclock-config-ref/">DmClock Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../bluestore-config-ref/">BlueStore Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../filestore-config-ref/">FileStore Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../journal-ref/">Journal Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pool-pg-config-ref/">Pool, PG &amp; CRUSH Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ms-ref/">Messaging Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../general-config-ref/">General Settings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../cephadm/">Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations/">Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/">Man Pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/">APIs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cephfs/">Ceph File System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rbd/">Ceph Block Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../radosgw/">Ceph Object Gateway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mgr/">Ceph Manager Daemon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mgr/dashboard/">Ceph Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture/">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/developer_guide/">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/internals/">Ceph Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../governance/">Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../foundation/">Ceph Foundation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.ceph.com/en/latest/releases/general/">Ceph Releases (general)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.ceph.com/en/latest/releases/">Ceph Releases (index)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security/">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary/">Glossary</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../http-routingtable/" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../mclock-config-ref/" title="mClock Config Reference"
             >next</a> |</li>
        <li class="right" >
          <a href="../mon-osd-interaction/" title="Configuring Monitor/OSD Interaction"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../" >Ceph Storage Cluster</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../" >Configuration</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">OSD Config Reference</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Ceph authors and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).
    </div>
  </body>
</html>