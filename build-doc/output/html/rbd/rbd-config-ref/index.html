
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Config Settings &#8212; Ceph Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/ceph.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="RBD Replay" href="../rbd-replay/" />
    <link rel="prev" title="Image Encryption" href="../rbd-encryption/" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../http-routingtable/" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../rbd-replay/" title="RBD Replay"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../rbd-encryption/" title="Image Encryption"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" >Ceph Block Device</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../rbd-operations/" accesskey="U">Ceph Block Device Operations</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Config Settings</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div id="docubetter" align="right" style="padding: 15px; font-weight: bold;">
    <a href="https://pad.ceph.com/p/Report_Documentation_Bugs">Report a Documentation Bug</a>
  </div>

  
  <section id="config-settings">
<h1>Config Settings<a class="headerlink" href="#config-settings" title="Permalink to this heading">¶</a></h1>
<p>See <a class="reference external" href="../../rbd">Block Device</a> for additional details.</p>
<section id="generic-io-settings">
<h2>Generic IO Settings<a class="headerlink" href="#generic-io-settings" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">rbd_compression_hint</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Hint to send to the OSDs on write operations. If set to
<code class="docutils literal notranslate"><span class="pre">compressible</span></code> and the OSD <code class="docutils literal notranslate"><span class="pre">bluestore_compression_mode</span></code>
setting is <code class="docutils literal notranslate"><span class="pre">passive</span></code>, the OSD will attempt to compress data
If set to <code class="docutils literal notranslate"><span class="pre">incompressible</span></code> and the OSD compression setting
is <code class="docutils literal notranslate"><span class="pre">aggressive</span></code>, the OSD will not attempt to compress data.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Enum</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">none</span></code></p>
</dd>
<dt class="field-odd">Values</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">none</span></code>, <code class="docutils literal notranslate"><span class="pre">compressible</span></code>, <code class="docutils literal notranslate"><span class="pre">incompressible</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_read_from_replica_policy</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Policy for determining which OSD will receive read operations.
If set to <code class="docutils literal notranslate"><span class="pre">default</span></code>, each PG’s primary OSD will always be used
for read operations. If set to <code class="docutils literal notranslate"><span class="pre">balance</span></code>, read operations will
be sent to a randomly selected OSD within the replica set. If set
to <code class="docutils literal notranslate"><span class="pre">localize</span></code>, read operations will be sent to the closest OSD
as determined by the CRUSH map. Note: this feature requires the
cluster to be configured with a minimum compatible OSD release of
Octopus.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Enum</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">default</span></code></p>
</dd>
<dt class="field-odd">Values</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">default</span></code>, <code class="docutils literal notranslate"><span class="pre">balance</span></code>, <code class="docutils literal notranslate"><span class="pre">localize</span></code></p>
</dd>
</dl>
</section>
<section id="cache-settings">
<h2>Cache Settings<a class="headerlink" href="#cache-settings" title="Permalink to this heading">¶</a></h2>
<aside class="sidebar">
<p class="sidebar-title">Kernel Caching</p>
<p>The kernel driver for Ceph block devices can use the Linux page cache to
improve performance.</p>
</aside>
<p>The user space implementation of the Ceph block device (i.e., <code class="docutils literal notranslate"><span class="pre">librbd</span></code>) cannot
take advantage of the Linux page cache, so it includes its own in-memory
caching, called “RBD caching.” RBD caching behaves just like well-behaved hard
disk caching.  When the OS sends a barrier or a flush request, all dirty data is
written to the OSDs. This means that using write-back caching is just as safe as
using a well-behaved physical hard disk with a VM that properly sends flushes
(i.e. Linux kernel &gt;= 2.6.32). The cache uses a Least Recently Used (LRU)
algorithm, and in write-back mode it can coalesce contiguous requests for
better throughput.</p>
<p>The librbd cache is enabled by default and supports three different cache
policies: write-around, write-back, and write-through. Writes return
immediately under both the write-around and write-back policies, unless there
are more than <code class="docutils literal notranslate"><span class="pre">rbd_cache_max_dirty</span></code> unwritten bytes to the storage cluster.
The write-around policy differs from the write-back policy in that it does
not attempt to service read requests from the cache, unlike the write-back
policy, and is therefore faster for high performance write workloads. Under the
write-through policy, writes return only when the data is on disk on all
replicas, but reads may come from the cache.</p>
<p>Prior to receiving a flush request, the cache behaves like a write-through cache
to ensure safe operation for older operating systems that do not send flushes to
ensure crash consistent behavior.</p>
<p>If the librbd cache is disabled, writes and
reads go directly to the storage cluster, and writes return only when the data
is on disk on all replicas.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cache is in memory on the client, and each RBD image has
its own.  Since the cache is local to the client, there’s no coherency
if there are others accessing the image. Running GFS or OCFS on top of
RBD will not work with caching enabled.</p>
</div>
<p>Option settings for RBD should be set in the <code class="docutils literal notranslate"><span class="pre">[client]</span></code>
section of your configuration file or the central config store. These settings
include:</p>
<p><code class="docutils literal notranslate"><span class="pre">rbd_cache</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Enable caching for RADOS Block Device (RBD).</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Boolean</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_cache_policy</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Select the caching policy for librbd.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Enum</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">writearound</span></code></p>
</dd>
<dt class="field-odd">Values</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">writearound</span></code>, <code class="docutils literal notranslate"><span class="pre">writeback</span></code>, <code class="docutils literal notranslate"><span class="pre">writethrough</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_cache_writethrough_until_flush</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Start out in <code class="docutils literal notranslate"><span class="pre">writethrough</span></code> mode, and switch to <code class="docutils literal notranslate"><span class="pre">writeback</span></code>
after the first flush request is received. Enabling is a
conservative but safe strategy in case VMs running on RBD volumes
are too old to send flushes, like the <code class="docutils literal notranslate"><span class="pre">virtio</span></code> driver in Linux
kernels older than 2.6.32.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Boolean</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_cache_size</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The per-volume RBD client cache size in bytes.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>64-bit Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">32</span> <span class="pre">MiB</span></code></p>
</dd>
<dt class="field-odd">Policies</dt>
<dd class="field-odd"><p>write-back and write-through</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_cache_max_dirty</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The <code class="docutils literal notranslate"><span class="pre">dirty</span></code> limit in bytes at which the cache triggers write-back.  If <code class="docutils literal notranslate"><span class="pre">0</span></code>, uses write-through caching.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>64-bit Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Constraint</dt>
<dd class="field-even"><p>Must be less than <code class="docutils literal notranslate"><span class="pre">rbd_cache_size</span></code>.</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">24</span> <span class="pre">MiB</span></code></p>
</dd>
<dt class="field-even">Policies</dt>
<dd class="field-even"><p>write-around and write-back</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_cache_target_dirty</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The <code class="docutils literal notranslate"><span class="pre">dirty</span> <span class="pre">target</span></code> before the cache begins writing data to the data storage. Does not block writes to the cache.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>64-bit Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Constraint</dt>
<dd class="field-even"><p>Must be less than <code class="docutils literal notranslate"><span class="pre">rbd_cache_max_dirty</span></code>.</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">16</span> <span class="pre">MiB</span></code></p>
</dd>
<dt class="field-even">Policies</dt>
<dd class="field-even"><p>write-back</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_cache_max_dirty_age</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The number of seconds dirty data is in the cache before writeback starts.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1.0</span></code></p>
</dd>
<dt class="field-odd">Policies</dt>
<dd class="field-odd"><p>write-back</p>
</dd>
</dl>
</section>
<section id="read-ahead-settings">
<h2>Read-ahead Settings<a class="headerlink" href="#read-ahead-settings" title="Permalink to this heading">¶</a></h2>
<p>librbd supports read-ahead/prefetching to optimize small, sequential reads.
This should normally be handled by the guest OS in the case of a VM,
but boot loaders may not issue efficient reads. Read-ahead is automatically
disabled if caching is disabled or if the policy is write-around.</p>
<p><code class="docutils literal notranslate"><span class="pre">rbd_readahead_trigger_requests</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Number of sequential read requests necessary to trigger read-ahead.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">10</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_readahead_max_bytes</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Maximum size of a read-ahead request.  If zero, read-ahead is disabled.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>64-bit Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">512</span> <span class="pre">KiB</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_readahead_disable_after_bytes</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>After this many bytes have been read from an RBD image, read-ahead
is disabled for that image until it is closed.  This allows the
guest OS to take over read-ahead once it is booted.  If zero,
read-ahead stays enabled.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>64-bit Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">50</span> <span class="pre">MiB</span></code></p>
</dd>
</dl>
</section>
<section id="image-features">
<h2>Image Features<a class="headerlink" href="#image-features" title="Permalink to this heading">¶</a></h2>
<p>RBD supports advanced features which can be specified via the command line when
creating images or the default features can be configured via
<code class="docutils literal notranslate"><span class="pre">rbd_default_features</span> <span class="pre">=</span> <span class="pre">&lt;sum</span> <span class="pre">of</span> <span class="pre">feature</span> <span class="pre">numeric</span> <span class="pre">values&gt;</span></code> or
<code class="docutils literal notranslate"><span class="pre">rbd_default_features</span> <span class="pre">=</span> <span class="pre">&lt;comma-delimited</span> <span class="pre">list</span> <span class="pre">of</span> <span class="pre">CLI</span> <span class="pre">values&gt;</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">Layering</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Layering enables cloning.</p>
</dd>
<dt class="field-even">Internal value</dt>
<dd class="field-even"><p>1</p>
</dd>
<dt class="field-odd">CLI value</dt>
<dd class="field-odd"><p>layering</p>
</dd>
<dt class="field-even">Added in</dt>
<dd class="field-even"><p>v0.52 (Bobtail)</p>
</dd>
<dt class="field-odd">KRBD support</dt>
<dd class="field-odd"><p>since v3.10</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p>yes</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Striping</span> <span class="pre">v2</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Striping spreads data across multiple objects. Striping helps with
parallelism for sequential read/write workloads.</p>
</dd>
<dt class="field-even">Internal value</dt>
<dd class="field-even"><p>2</p>
</dd>
<dt class="field-odd">CLI value</dt>
<dd class="field-odd"><p>striping</p>
</dd>
<dt class="field-even">Added in</dt>
<dd class="field-even"><p>v0.55 (Bobtail)</p>
</dd>
<dt class="field-odd">KRBD support</dt>
<dd class="field-odd"><p>since v3.10 (default striping only, “fancy” striping added in v4.17)</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p>yes</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Exclusive</span> <span class="pre">locking</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>When enabled, it requires a client to acquire a lock on an object
before making a write. Exclusive lock should only be enabled when
a single client is accessing an image at any given time.</p>
</dd>
<dt class="field-even">Internal value</dt>
<dd class="field-even"><p>4</p>
</dd>
<dt class="field-odd">CLI value</dt>
<dd class="field-odd"><p>exclusive-lock</p>
</dd>
<dt class="field-even">Added in</dt>
<dd class="field-even"><p>v0.92 (Hammer)</p>
</dd>
<dt class="field-odd">KRBD support</dt>
<dd class="field-odd"><p>since v4.9</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p>yes</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Object</span> <span class="pre">map</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Object map support depends on exclusive lock support. Block
devices are thin provisioned, which means that they only store
data that actually has been written, ie. they are <em>sparse</em>. Object
map support helps track which objects actually exist (have data
stored on a device). Enabling object map support speeds up I/O
operations for cloning, importing and exporting a sparsely
populated image, and deleting.</p>
</dd>
<dt class="field-even">Internal value</dt>
<dd class="field-even"><p>8</p>
</dd>
<dt class="field-odd">CLI value</dt>
<dd class="field-odd"><p>object-map</p>
</dd>
<dt class="field-even">Added in</dt>
<dd class="field-even"><p>v0.93 (Hammer)</p>
</dd>
<dt class="field-odd">KRBD support</dt>
<dd class="field-odd"><p>since v5.3</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p>yes</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Fast-diff</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Fast-diff support depends on object map support and exclusive lock
support. It adds another property to the object map, which makes
it much faster to generate diffs between snapshots of an image.
It is also much faster to calculate the actual data usage of a
snapshot or volume (<code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">du</span></code>).</p>
</dd>
<dt class="field-even">Internal value</dt>
<dd class="field-even"><p>16</p>
</dd>
<dt class="field-odd">CLI value</dt>
<dd class="field-odd"><p>fast-diff</p>
</dd>
<dt class="field-even">Added in</dt>
<dd class="field-even"><p>v9.0.1 (Infernalis)</p>
</dd>
<dt class="field-odd">KRBD support</dt>
<dd class="field-odd"><p>since v5.3</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p>yes</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Deep-flatten</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Deep-flatten enables <code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">flatten</span></code> to work on all  snapshots of
an image, in addition to the image itself. Without it, snapshots
of an image will still rely on the parent, so the parent cannot be
deleted until the snapshots are first deleted. Deep-flatten makes
a parent independent of its clones, even if they have snapshots,
at the expense of using additional OSD device space.</p>
</dd>
<dt class="field-even">Internal value</dt>
<dd class="field-even"><p>32</p>
</dd>
<dt class="field-odd">CLI value</dt>
<dd class="field-odd"><p>deep-flatten</p>
</dd>
<dt class="field-even">Added in</dt>
<dd class="field-even"><p>v9.0.2 (Infernalis)</p>
</dd>
<dt class="field-odd">KRBD support</dt>
<dd class="field-odd"><p>since v5.1</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p>yes</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Journaling</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Journaling support depends on exclusive lock support. Journaling
records all modifications to an image in the order they occur. RBD
mirroring can utilize the journal to replicate a crash-consistent
image to a remote cluster.  It is best to let <code class="docutils literal notranslate"><span class="pre">rbd-mirror</span></code>
manage this feature only as needed, as enabling it long term may
result in substantial additional OSD space consumption.</p>
</dd>
<dt class="field-even">Internal value</dt>
<dd class="field-even"><p>64</p>
</dd>
<dt class="field-odd">CLI value</dt>
<dd class="field-odd"><p>journaling</p>
</dd>
<dt class="field-even">Added in</dt>
<dd class="field-even"><p>v10.0.1 (Jewel)</p>
</dd>
<dt class="field-odd">KRBD support</dt>
<dd class="field-odd"><p>no</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p>no</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">pool</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>On erasure-coded pools, the image data block objects need to be stored on a separate pool from the image metadata.</p>
</dd>
<dt class="field-even">Internal value</dt>
<dd class="field-even"><p>128</p>
</dd>
<dt class="field-odd">Added in</dt>
<dd class="field-odd"><p>v11.1.0 (Kraken)</p>
</dd>
<dt class="field-even">KRBD support</dt>
<dd class="field-even"><p>since v4.11</p>
</dd>
<dt class="field-odd">Default</dt>
<dd class="field-odd"><p>no</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Operations</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Used to restrict older clients from performing certain maintenance operations against an image (e.g. clone, snap create).</p>
</dd>
<dt class="field-even">Internal value</dt>
<dd class="field-even"><p>256</p>
</dd>
<dt class="field-odd">Added in</dt>
<dd class="field-odd"><p>v13.0.2 (Mimic)</p>
</dd>
<dt class="field-even">KRBD support</dt>
<dd class="field-even"><p>since v4.16</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Migrating</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Used to restrict older clients from opening an image when it is in migration state.</p>
</dd>
<dt class="field-even">Internal value</dt>
<dd class="field-even"><p>512</p>
</dd>
<dt class="field-odd">Added in</dt>
<dd class="field-odd"><p>v14.0.1 (Nautilus)</p>
</dd>
<dt class="field-even">KRBD support</dt>
<dd class="field-even"><p>no</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Non-primary</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Used to restrict changes to non-primary images using snapshot-based mirroring.</p>
</dd>
<dt class="field-even">Internal value</dt>
<dd class="field-even"><p>1024</p>
</dd>
<dt class="field-odd">Added in</dt>
<dd class="field-odd"><p>v15.2.0 (Octopus)</p>
</dd>
<dt class="field-even">KRBD support</dt>
<dd class="field-even"><p>no</p>
</dd>
</dl>
</section>
<section id="qos-settings">
<h2>QOS Settings<a class="headerlink" href="#qos-settings" title="Permalink to this heading">¶</a></h2>
<p>librbd supports limiting per-image IO, controlled by the following
settings.</p>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_iops_limit</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired limit of IO operations per second.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_bps_limit</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired limit of IO bytes per second.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_read_iops_limit</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired limit of read operations per second.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_write_iops_limit</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired limit of write operations per second.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_read_bps_limit</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired limit of read bytes per second.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_writ_bps_limit</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired limit of write bytes per second.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_iops_burst</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired burst limit of IO operations.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_bps_burst</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired burst limit of IO bytes.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_read_iops_burst</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired burst limit of read operations.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_write_iops_burst</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired burst limit of write operations.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_read_bps_burst</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired burst limit of read bytes per second.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_write_bps_burst</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired burst limit of write bytes per second.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_iops_burst_seconds</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired burst duration in seconds of IO operations.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_bps_burst_seconds</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired burst duration in seconds.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_read_iops_burst_seconds</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired burst duration in seconds of read operations.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_write_iops_burst_seconds</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired burst duration in seconds of write operations.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_read_bps_burst_seconds</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired burst duration in seconds of read bytes.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_write_bps_burst_seconds</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The desired burst duration in seconds of write bytes.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd_qos_schedule_tick_min</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The minimum schedule tick (in milliseconds) for QoS.</p>
</dd>
<dt class="field-even">Type</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">Required</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">50</span></code></p>
</dd>
</dl>
</section>
</section>



            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/intro/">Intro to Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">Installing Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephadm/">Cephadm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rados/">Ceph Storage Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephfs/">Ceph File System</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Ceph Block Device</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../rados-rbd-cmds/">Basic Commands</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../rbd-operations/">Operations</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../rbd-snapshot/">Snapshots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rbd-exclusive-locks/">Exclusive Locking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rbd-mirroring/">Mirroring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rbd-live-migration/">Live-Migration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rbd-persistent-read-only-cache/">Persistent Read-only Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rbd-persistent-write-back-cache/">Persistent Write-back Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rbd-encryption/">Encryption</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Config Settings (librbd)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#generic-io-settings">Generic IO Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cache-settings">Cache Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#read-ahead-settings">Read-ahead Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#image-features">Image Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qos-settings">QOS Settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../rbd-replay/">RBD Replay</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../rbd-integrations/">Integrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../man/">Manpages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/">APIs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../radosgw/">Ceph Object Gateway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mgr/">Ceph Manager Daemon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mgr/dashboard/">Ceph Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/developer_guide/">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/internals/">Ceph Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../governance/">Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../foundation/">Ceph Foundation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.ceph.com/en/latest/releases/general/">Ceph Releases (general)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.ceph.com/en/latest/releases/">Ceph Releases (index)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Glossary</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../http-routingtable/" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../rbd-replay/" title="RBD Replay"
             >next</a> |</li>
        <li class="right" >
          <a href="../rbd-encryption/" title="Image Encryption"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" >Ceph Block Device</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../rbd-operations/" >Ceph Block Device Operations</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Config Settings</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Ceph authors and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).
    </div>
  </body>
</html>