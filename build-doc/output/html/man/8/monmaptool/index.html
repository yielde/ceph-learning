
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>monmaptool – ceph monitor cluster map manipulation tool &#8212; Ceph Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/ceph.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="next" title="osdmaptool – ceph osd cluster map manipulation tool" href="../osdmaptool/" />
    <link rel="prev" title="librados-config – display information about librados" href="../librados-config/" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../http-routingtable/" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../osdmaptool/" title="osdmaptool – ceph osd cluster map manipulation tool"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../librados-config/" title="librados-config – display information about librados"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../rados/" >Ceph Storage Cluster</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../../rados/man/" accesskey="U">Object Store Manpages</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">monmaptool – ceph monitor cluster map manipulation tool</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div id="docubetter" align="right" style="padding: 15px; font-weight: bold;">
    <a href="https://pad.ceph.com/p/Report_Documentation_Bugs">Report a Documentation Bug</a>
  </div>

  
  <section id="monmaptool-ceph-monitor-cluster-map-manipulation-tool">
<h1>monmaptool – ceph monitor cluster map manipulation tool<a class="headerlink" href="#monmaptool-ceph-monitor-cluster-map-manipulation-tool" title="Permalink to this heading">¶</a></h1>
<section id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this heading">¶</a></h2>
<div class="line-block">
<div class="line"><strong>monmaptool</strong> &lt;action&gt; [options] <em>mapfilename</em></div>
</div>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p><strong>monmaptool</strong> is a utility to create, view, and modify a monitor
cluster map for the Ceph distributed storage system. The monitor map
specifies the only fixed addresses in the Ceph distributed system.
All other daemons bind to arbitrary addresses and register themselves
with the monitors.</p>
<p>When creating a map with –create, a new monitor map with a new,
random UUID will be created. It should be followed by one or more
monitor addresses.</p>
<p>The default Ceph monitor port for messenger protocol v1 is 6789, and
3300 for protocol v2.</p>
<p>Multiple actions can be performed per invocation.</p>
</section>
<section id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this heading">¶</a></h2>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-monmaptool-print">
<span class="sig-name descname"><span class="pre">--print</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-monmaptool-print" title="Permalink to this definition">¶</a></dt>
<dd><p>print a plaintext dump of the map, after any modifications are
made.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-monmaptool-feature-list">
<span class="sig-name descname"><span class="pre">--feature-list</span></span><span class="sig-prename descclassname"> <span class="pre">[plain|parseable]</span></span><a class="headerlink" href="#cmdoption-monmaptool-feature-list" title="Permalink to this definition">¶</a></dt>
<dd><p>list the enabled features as well as the available ones.</p>
<p>By default, a human readable output is produced.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-monmaptool-create">
<span class="sig-name descname"><span class="pre">--create</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-monmaptool-create" title="Permalink to this definition">¶</a></dt>
<dd><p>create a new monitor map with a new UUID (and with it, a new,
empty Ceph cluster).</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-monmaptool-clobber">
<span class="sig-name descname"><span class="pre">--clobber</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-monmaptool-clobber" title="Permalink to this definition">¶</a></dt>
<dd><p>allow monmaptool to create a new mapfilename in place of an existing map.</p>
<p>Only useful when <em>–create</em> is used.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-monmaptool-generate">
<span class="sig-name descname"><span class="pre">--generate</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-monmaptool-generate" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a new monmap based on the values on the command line or specified
in the ceph configuration.  This is, in order of preference,</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--monmap</span> <span class="pre">filename</span></code> to specify a monmap to load</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--mon-host</span> <span class="pre">'host1,ip2'</span></code> to specify a list of hosts or ip addresses</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[mon.foo]</span></code> sections containing <code class="docutils literal notranslate"><span class="pre">mon</span> <span class="pre">addr</span></code> settings in the config. Note that this method is not recommended and support will be removed in a future release.</p></li>
</ol>
</div></blockquote>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-monmaptool-filter-initial-members">
<span class="sig-name descname"><span class="pre">--filter-initial-members</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-monmaptool-filter-initial-members" title="Permalink to this definition">¶</a></dt>
<dd><p>filter the initial monmap by applying the <code class="docutils literal notranslate"><span class="pre">mon</span> <span class="pre">initial</span> <span class="pre">members</span></code>
setting.  Monitors not present in that list will be removed, and
initial members not present in the map will be added with dummy
addresses.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-monmaptool-add">
<span class="sig-name descname"><span class="pre">--add</span></span><span class="sig-prename descclassname"> <span class="pre">name</span> <span class="pre">ip[:port]</span></span><a class="headerlink" href="#cmdoption-monmaptool-add" title="Permalink to this definition">¶</a></dt>
<dd><p>add a monitor with the specified ip:port to the map.</p>
<p>If the <em>nautilus</em> feature is set, and the port is not, the monitor
will be added for both messenger protocols.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-monmaptool-addv">
<span class="sig-name descname"><span class="pre">--addv</span></span><span class="sig-prename descclassname"> <span class="pre">name</span> <span class="pre">[protocol:ip:port[,...]]</span></span><a class="headerlink" href="#cmdoption-monmaptool-addv" title="Permalink to this definition">¶</a></dt>
<dd><p>add a monitor with the specified version:ip:port to the map.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-monmaptool-rm">
<span class="sig-name descname"><span class="pre">--rm</span></span><span class="sig-prename descclassname"> <span class="pre">name</span></span><a class="headerlink" href="#cmdoption-monmaptool-rm" title="Permalink to this definition">¶</a></dt>
<dd><p>remove the monitor with the specified name from the map.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-monmaptool-fsid">
<span class="sig-name descname"><span class="pre">--fsid</span></span><span class="sig-prename descclassname"> <span class="pre">uuid</span></span><a class="headerlink" href="#cmdoption-monmaptool-fsid" title="Permalink to this definition">¶</a></dt>
<dd><p>set the fsid to the given uuid.  If not specified with <em>–create</em>, a random fsid will be generated.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-monmaptool-feature-set">
<span class="sig-name descname"><span class="pre">--feature-set</span></span><span class="sig-prename descclassname"> <span class="pre">value</span> <span class="pre">[--optional|--persistent]</span></span><a class="headerlink" href="#cmdoption-monmaptool-feature-set" title="Permalink to this definition">¶</a></dt>
<dd><p>enable a feature.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-monmaptool-feature-unset">
<span class="sig-name descname"><span class="pre">--feature-unset</span></span><span class="sig-prename descclassname"> <span class="pre">value</span> <span class="pre">[--optional|--persistent]</span></span><a class="headerlink" href="#cmdoption-monmaptool-feature-unset" title="Permalink to this definition">¶</a></dt>
<dd><p>disable a feature.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-monmaptool-enable-all-features">
<span class="sig-name descname"><span class="pre">--enable-all-features</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-monmaptool-enable-all-features" title="Permalink to this definition">¶</a></dt>
<dd><p>enable all supported features.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-monmaptool-set-min-mon-release">
<span class="sig-name descname"><span class="pre">--set-min-mon-release</span></span><span class="sig-prename descclassname"> <span class="pre">release</span></span><a class="headerlink" href="#cmdoption-monmaptool-set-min-mon-release" title="Permalink to this definition">¶</a></dt>
<dd><p>set the min_mon_release.</p>
</dd></dl>

</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this heading">¶</a></h2>
<p>To create a new map with three monitors (for a fresh Ceph cluster):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">monmaptool</span> <span class="o">--</span><span class="n">create</span> <span class="o">--</span><span class="n">add</span> <span class="n">nodeA</span> <span class="mf">192.168.0.10</span> <span class="o">--</span><span class="n">add</span> <span class="n">nodeB</span> <span class="mf">192.168.0.11</span> \
  <span class="o">--</span><span class="n">add</span> <span class="n">nodeC</span> <span class="mf">192.168.0.12</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="nb">all</span><span class="o">-</span><span class="n">features</span> <span class="o">--</span><span class="n">clobber</span> <span class="n">monmap</span>
</pre></div>
</div>
<p>To display the contents of the map:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">monmaptool</span> <span class="o">--</span><span class="nb">print</span> <span class="n">monmap</span>
</pre></div>
</div>
<p>To replace one monitor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">monmaptool</span> <span class="o">--</span><span class="n">rm</span> <span class="n">nodeA</span> <span class="n">monmap</span>
<span class="n">monmaptool</span> <span class="o">--</span><span class="n">add</span> <span class="n">nodeA</span> <span class="mf">192.168.0.9</span> <span class="n">monmap</span>
</pre></div>
</div>
</section>
<section id="availability">
<h2>Availability<a class="headerlink" href="#availability" title="Permalink to this heading">¶</a></h2>
<p><strong>monmaptool</strong> is part of Ceph, a massively scalable, open-source, distributed
storage system. Please refer to the Ceph documentation at <a class="reference external" href="http://ceph.com/docs">http://ceph.com/docs</a>
for more information.</p>
</section>
<section id="see-also">
<h2>See also<a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="../ceph/"><span class="doc">ceph</span></a>(8),
<a class="reference internal" href="../crushtool/"><span class="doc">crushtool</span></a>(8),</p>
</section>
</section>



            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../">
              <img class="logo" src="../../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../start/intro/">Intro to Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/">Installing Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cephadm/">Cephadm</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../rados/">Ceph Storage Cluster</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../rados/configuration/">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cephadm/">Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rados/operations/">Operations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../rados/man/">Man Pages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../ceph-volume/">ceph-volume – Ceph OSD deployment and inspection tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-volume-systemd/">ceph-volume-systemd – systemd ceph-volume helper tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph/">ceph – ceph administration tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-authtool/">ceph-authtool – ceph keyring manipulation tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-clsinfo/">ceph-clsinfo – show class object information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-conf/">ceph-conf – ceph conf file tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-debugpack/">ceph-debugpack – ceph debug packer utility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-dencoder/">ceph-dencoder – ceph encoder/decoder utility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-mon/">ceph-mon – ceph monitor daemon</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-osd/">ceph-osd – ceph object storage daemon</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-kvstore-tool/">ceph-kvstore-tool – ceph kvstore manipulation tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-run/">ceph-run – restart daemon on core dump</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-syn/">ceph-syn – ceph synthetic workload generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../crushtool/">crushtool – CRUSH map manipulation tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../librados-config/">librados-config – display information about librados</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">monmaptool – ceph monitor cluster map manipulation tool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#synopsis">Synopsis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#options">Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#availability">Availability</a></li>
<li class="toctree-l4"><a class="reference internal" href="#see-also">See also</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../osdmaptool/">osdmaptool – ceph osd cluster map manipulation tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rados/">rados – rados object storage utility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-post-file/">ceph-post-file – post files for ceph developers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../rados/troubleshooting/">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rados/api/">APIs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cephfs/">Ceph File System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rbd/">Ceph Block Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../radosgw/">Ceph Object Gateway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mgr/">Ceph Manager Daemon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mgr/dashboard/">Ceph Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture/">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/developer_guide/">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/internals/">Ceph Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../governance/">Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../foundation/">Ceph Foundation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.ceph.com/en/latest/releases/general/">Ceph Releases (general)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.ceph.com/en/latest/releases/">Ceph Releases (index)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security/">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary/">Glossary</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../http-routingtable/" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../osdmaptool/" title="osdmaptool – ceph osd cluster map manipulation tool"
             >next</a> |</li>
        <li class="right" >
          <a href="../librados-config/" title="librados-config – display information about librados"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../rados/" >Ceph Storage Cluster</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../../rados/man/" >Object Store Manpages</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">monmaptool – ceph monitor cluster map manipulation tool</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Ceph authors and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).
    </div>
  </body>
</html>