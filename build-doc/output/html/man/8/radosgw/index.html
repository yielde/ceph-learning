
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>radosgw – rados REST gateway &#8212; Ceph Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/ceph.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="next" title="radosgw-admin – rados REST gateway user administration utility" href="../radosgw-admin/" />
    <link rel="prev" title="Troubleshooting" href="../../../radosgw/troubleshooting/" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../http-routingtable/" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../radosgw-admin/" title="radosgw-admin – rados REST gateway user administration utility"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../../radosgw/troubleshooting/" title="Troubleshooting"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../radosgw/" accesskey="U">Ceph Object Gateway</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">radosgw – rados REST gateway</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div id="docubetter" align="right" style="padding: 15px; font-weight: bold;">
    <a href="https://pad.ceph.com/p/Report_Documentation_Bugs">Report a Documentation Bug</a>
  </div>

  
  <section id="radosgw-rados-rest-gateway">
<h1>radosgw – rados REST gateway<a class="headerlink" href="#radosgw-rados-rest-gateway" title="Permalink to this heading">¶</a></h1>
<section id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this heading">¶</a></h2>
<div class="line-block">
<div class="line"><strong>radosgw</strong></div>
</div>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h2>
<p><strong class="program">radosgw</strong> is an HTTP REST gateway for the RADOS object store, a part
of the Ceph distributed storage system. It is implemented as a FastCGI
module using libfcgi, and can be used in conjunction with any FastCGI
capable web server.</p>
</section>
<section id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this heading">¶</a></h2>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-radosgw-c">
<span id="cmdoption-radosgw-conf"></span><span class="sig-name descname"><span class="pre">-c</span></span><span class="sig-prename descclassname"> <span class="pre">ceph.conf</span></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--conf</span></span><span class="sig-prename descclassname"><span class="pre">=ceph.conf</span></span><a class="headerlink" href="#cmdoption-radosgw-c" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <code class="docutils literal notranslate"><span class="pre">ceph.conf</span></code> configuration file instead of the default
<code class="docutils literal notranslate"><span class="pre">/etc/ceph/ceph.conf</span></code> to determine monitor addresses during startup.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-radosgw-m">
<span class="sig-name descname"><span class="pre">-m</span></span><span class="sig-prename descclassname"> <span class="pre">monaddress[:port]</span></span><a class="headerlink" href="#cmdoption-radosgw-m" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to specified monitor (instead of looking through <code class="docutils literal notranslate"><span class="pre">ceph.conf</span></code>).</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-radosgw-i">
<span id="cmdoption-radosgw-id"></span><span class="sig-name descname"><span class="pre">-i</span></span><span class="sig-prename descclassname"> <span class="pre">ID</span></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--id</span></span><span class="sig-prename descclassname"> <span class="pre">ID</span></span><a class="headerlink" href="#cmdoption-radosgw-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the ID portion of name for radosgw</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-radosgw-n">
<span id="cmdoption-radosgw-name"></span><span class="sig-name descname"><span class="pre">-n</span></span><span class="sig-prename descclassname"> <span class="pre">TYPE.ID</span></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--name</span></span><span class="sig-prename descclassname"> <span class="pre">TYPE.ID</span></span><a class="headerlink" href="#cmdoption-radosgw-n" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the rados user name for the gateway (eg. client.radosgw.gateway)</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-radosgw-cluster">
<span class="sig-name descname"><span class="pre">--cluster</span></span><span class="sig-prename descclassname"> <span class="pre">NAME</span></span><a class="headerlink" href="#cmdoption-radosgw-cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the cluster name (default: ceph)</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-radosgw-d">
<span class="sig-name descname"><span class="pre">-d</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-radosgw-d" title="Permalink to this definition">¶</a></dt>
<dd><p>Run in foreground, log to stderr</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-radosgw-f">
<span class="sig-name descname"><span class="pre">-f</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-radosgw-f" title="Permalink to this definition">¶</a></dt>
<dd><p>Run in foreground, log to usual location</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-radosgw-rgw-socket-path">
<span class="sig-name descname"><span class="pre">--rgw-socket-path</span></span><span class="sig-prename descclassname"><span class="pre">=path</span></span><a class="headerlink" href="#cmdoption-radosgw-rgw-socket-path" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify a unix domain socket path.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-radosgw-rgw-region">
<span class="sig-name descname"><span class="pre">--rgw-region</span></span><span class="sig-prename descclassname"><span class="pre">=region</span></span><a class="headerlink" href="#cmdoption-radosgw-rgw-region" title="Permalink to this definition">¶</a></dt>
<dd><p>The region where radosgw runs</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-radosgw-rgw-zone">
<span class="sig-name descname"><span class="pre">--rgw-zone</span></span><span class="sig-prename descclassname"><span class="pre">=zone</span></span><a class="headerlink" href="#cmdoption-radosgw-rgw-zone" title="Permalink to this definition">¶</a></dt>
<dd><p>The zone where radosgw runs</p>
</dd></dl>

</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading">¶</a></h2>
<p>Earlier RADOS Gateway had to be configured with <code class="docutils literal notranslate"><span class="pre">Apache</span></code> and <code class="docutils literal notranslate"><span class="pre">mod_fastcgi</span></code>.
Now, <code class="docutils literal notranslate"><span class="pre">mod_proxy_fcgi</span></code> module is used instead of <code class="docutils literal notranslate"><span class="pre">mod_fastcgi</span></code>.
<code class="docutils literal notranslate"><span class="pre">mod_proxy_fcgi</span></code> works differently than a traditional FastCGI module. This
module requires the service of <code class="docutils literal notranslate"><span class="pre">mod_proxy</span></code> which provides support for the
FastCGI protocol. So, to be able to handle FastCGI protocol, both <code class="docutils literal notranslate"><span class="pre">mod_proxy</span></code>
and <code class="docutils literal notranslate"><span class="pre">mod_proxy_fcgi</span></code> have to be present in the server. Unlike <code class="docutils literal notranslate"><span class="pre">mod_fastcgi</span></code>,
<code class="docutils literal notranslate"><span class="pre">mod_proxy_fcgi</span></code> cannot start the application process. Some platforms have
<code class="docutils literal notranslate"><span class="pre">fcgistarter</span></code> for that purpose. However, external launching of application
or process management may be available in the FastCGI application framework
in use.</p>
<p><code class="docutils literal notranslate"><span class="pre">Apache</span></code> can be configured in a way that enables <code class="docutils literal notranslate"><span class="pre">mod_proxy_fcgi</span></code> to be used
with localhost tcp or through unix domain socket. <code class="docutils literal notranslate"><span class="pre">mod_proxy_fcgi</span></code> that doesn’t
support unix domain socket such as the ones in Apache 2.2 and earlier versions of
Apache 2.4, needs to be configured for use with localhost tcp. Later versions of
Apache like Apache 2.4.9 or later support unix domain socket and as such they
allow for the configuration with unix domain socket instead of localhost tcp.</p>
<p>The following steps show the configuration in Ceph’s configuration file i.e,
<code class="docutils literal notranslate"><span class="pre">/etc/ceph/ceph.conf</span></code> and the gateway configuration file i.e,
<code class="docutils literal notranslate"><span class="pre">/etc/httpd/conf.d/rgw.conf</span></code> (RPM-based distros) or
<code class="docutils literal notranslate"><span class="pre">/etc/apache2/conf-available/rgw.conf</span></code> (Debian-based distros) with localhost
tcp and through unix domain socket:</p>
<ol class="arabic">
<li><p>For distros with Apache 2.2 and early versions of Apache 2.4 that use
localhost TCP and do not support Unix Domain Socket, append the following
contents to <code class="docutils literal notranslate"><span class="pre">/etc/ceph/ceph.conf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">gateway</span><span class="p">]</span>
<span class="n">host</span> <span class="o">=</span> <span class="p">{</span><span class="n">hostname</span><span class="p">}</span>
<span class="n">keyring</span> <span class="o">=</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ceph</span><span class="o">/</span><span class="n">ceph</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">keyring</span>
<span class="n">rgw</span> <span class="n">socket</span> <span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">log</span> <span class="n">file</span> <span class="o">=</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">ceph</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">log</span>
<span class="n">rgw</span> <span class="n">frontends</span> <span class="o">=</span> <span class="n">fastcgi</span> <span class="n">socket_port</span><span class="o">=</span><span class="mi">9000</span> <span class="n">socket_host</span><span class="o">=</span><span class="mf">0.0.0.0</span>
<span class="n">rgw</span> <span class="nb">print</span> <span class="k">continue</span> <span class="o">=</span> <span class="n">false</span>
</pre></div>
</div>
</li>
<li><p>Add the following content in the gateway configuration file:</p>
<p>For Debian/Ubuntu add in <code class="docutils literal notranslate"><span class="pre">/etc/apache2/conf-available/rgw.conf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">VirtualHost</span> <span class="o">*</span><span class="p">:</span><span class="mi">80</span><span class="o">&gt;</span>
<span class="n">ServerName</span> <span class="n">localhost</span>
<span class="n">DocumentRoot</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span>

<span class="n">ErrorLog</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">rgw_error</span><span class="o">.</span><span class="n">log</span>
<span class="n">CustomLog</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">apache2</span><span class="o">/</span><span class="n">rgw_access</span><span class="o">.</span><span class="n">log</span> <span class="n">combined</span>

<span class="c1"># LogLevel debug</span>

<span class="n">RewriteEngine</span> <span class="n">On</span>

<span class="n">RewriteRule</span> <span class="o">.*</span> <span class="o">-</span> <span class="p">[</span><span class="n">E</span><span class="o">=</span><span class="n">HTTP_AUTHORIZATION</span><span class="p">:</span><span class="o">%</span><span class="p">{</span><span class="n">HTTP</span><span class="p">:</span><span class="n">Authorization</span><span class="p">},</span><span class="n">L</span><span class="p">]</span>

<span class="n">SetEnv</span> <span class="n">proxy</span><span class="o">-</span><span class="n">nokeepalive</span> <span class="mi">1</span>

<span class="n">ProxyPass</span> <span class="o">/</span> <span class="n">fcgi</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">9000</span><span class="o">/</span>

<span class="o">&lt;/</span><span class="n">VirtualHost</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>For CentOS/RHEL add in <code class="docutils literal notranslate"><span class="pre">/etc/httpd/conf.d/rgw.conf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">VirtualHost</span> <span class="o">*</span><span class="p">:</span><span class="mi">80</span><span class="o">&gt;</span>
<span class="n">ServerName</span> <span class="n">localhost</span>
<span class="n">DocumentRoot</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span>

<span class="n">ErrorLog</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">httpd</span><span class="o">/</span><span class="n">rgw_error</span><span class="o">.</span><span class="n">log</span>
<span class="n">CustomLog</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">httpd</span><span class="o">/</span><span class="n">rgw_access</span><span class="o">.</span><span class="n">log</span> <span class="n">combined</span>

<span class="c1"># LogLevel debug</span>

<span class="n">RewriteEngine</span> <span class="n">On</span>

<span class="n">RewriteRule</span> <span class="o">.*</span> <span class="o">-</span> <span class="p">[</span><span class="n">E</span><span class="o">=</span><span class="n">HTTP_AUTHORIZATION</span><span class="p">:</span><span class="o">%</span><span class="p">{</span><span class="n">HTTP</span><span class="p">:</span><span class="n">Authorization</span><span class="p">},</span><span class="n">L</span><span class="p">]</span>

<span class="n">SetEnv</span> <span class="n">proxy</span><span class="o">-</span><span class="n">nokeepalive</span> <span class="mi">1</span>

<span class="n">ProxyPass</span> <span class="o">/</span> <span class="n">fcgi</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">9000</span><span class="o">/</span>

<span class="o">&lt;/</span><span class="n">VirtualHost</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>For distros with Apache 2.4.9 or later that support Unix Domain Socket,
append the following configuration to <code class="docutils literal notranslate"><span class="pre">/etc/ceph/ceph.conf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">gateway</span><span class="p">]</span>
<span class="n">host</span> <span class="o">=</span> <span class="p">{</span><span class="n">hostname</span><span class="p">}</span>
<span class="n">keyring</span> <span class="o">=</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ceph</span><span class="o">/</span><span class="n">ceph</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">keyring</span>
<span class="n">rgw</span> <span class="n">socket</span> <span class="n">path</span> <span class="o">=</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">ceph</span><span class="o">/</span><span class="n">ceph</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">fastcgi</span><span class="o">.</span><span class="n">sock</span>
<span class="n">log</span> <span class="n">file</span> <span class="o">=</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">ceph</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">log</span>
<span class="n">rgw</span> <span class="nb">print</span> <span class="k">continue</span> <span class="o">=</span> <span class="n">false</span>
</pre></div>
</div>
</li>
<li><p>Add the following content in the gateway configuration file:</p>
<p>For CentOS/RHEL add in <code class="docutils literal notranslate"><span class="pre">/etc/httpd/conf.d/rgw.conf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">VirtualHost</span> <span class="o">*</span><span class="p">:</span><span class="mi">80</span><span class="o">&gt;</span>
<span class="n">ServerName</span> <span class="n">localhost</span>
<span class="n">DocumentRoot</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span>

<span class="n">ErrorLog</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">httpd</span><span class="o">/</span><span class="n">rgw_error</span><span class="o">.</span><span class="n">log</span>
<span class="n">CustomLog</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">httpd</span><span class="o">/</span><span class="n">rgw_access</span><span class="o">.</span><span class="n">log</span> <span class="n">combined</span>

<span class="c1"># LogLevel debug</span>

<span class="n">RewriteEngine</span> <span class="n">On</span>

<span class="n">RewriteRule</span> <span class="o">.*</span> <span class="o">-</span> <span class="p">[</span><span class="n">E</span><span class="o">=</span><span class="n">HTTP_AUTHORIZATION</span><span class="p">:</span><span class="o">%</span><span class="p">{</span><span class="n">HTTP</span><span class="p">:</span><span class="n">Authorization</span><span class="p">},</span><span class="n">L</span><span class="p">]</span>

<span class="n">SetEnv</span> <span class="n">proxy</span><span class="o">-</span><span class="n">nokeepalive</span> <span class="mi">1</span>

<span class="n">ProxyPass</span> <span class="o">/</span> <span class="n">unix</span><span class="p">:</span><span class="o">///</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">ceph</span><span class="o">/</span><span class="n">ceph</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">gateway</span><span class="o">.</span><span class="n">fastcgi</span><span class="o">.</span><span class="n">sock</span><span class="o">|</span><span class="n">fcgi</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">9000</span><span class="o">/</span>

<span class="o">&lt;/</span><span class="n">VirtualHost</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Please note, <code class="docutils literal notranslate"><span class="pre">Apache</span> <span class="pre">2.4.7</span></code> does not have Unix Domain Socket support in
it and as such it has to be configured with localhost tcp. The Unix Domain
Socket support is available in <code class="docutils literal notranslate"><span class="pre">Apache</span> <span class="pre">2.4.9</span></code> and later versions.</p>
</li>
<li><p>Generate a key for radosgw to use for authentication with the cluster.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span><span class="o">-</span><span class="n">authtool</span> <span class="o">-</span><span class="n">C</span> <span class="o">-</span><span class="n">n</span> <span class="n">client</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">gateway</span> <span class="o">--</span><span class="n">gen</span><span class="o">-</span><span class="n">key</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ceph</span><span class="o">/</span><span class="n">keyring</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">gateway</span>
<span class="n">ceph</span><span class="o">-</span><span class="n">authtool</span> <span class="o">-</span><span class="n">n</span> <span class="n">client</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">gateway</span> <span class="o">--</span><span class="n">cap</span> <span class="n">mon</span> <span class="s1">&#39;allow rw&#39;</span> <span class="o">--</span><span class="n">cap</span> <span class="n">osd</span> <span class="s1">&#39;allow rwx&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">ceph</span><span class="o">/</span><span class="n">keyring</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">gateway</span>
</pre></div>
</div>
</li>
<li><p>Add the key to the auth entries.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">auth</span> <span class="n">add</span> <span class="n">client</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">gateway</span> <span class="o">--</span><span class="ow">in</span><span class="o">-</span><span class="n">file</span><span class="o">=</span><span class="n">keyring</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">gateway</span>
</pre></div>
</div>
</li>
<li><p>Start Apache and radosgw.</p>
<p>Debian/Ubuntu:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">apache2</span> <span class="n">start</span>
<span class="n">sudo</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">radosgw</span> <span class="n">start</span>
</pre></div>
</div>
<p>CentOS/RHEL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apachectl</span> <span class="n">start</span>
<span class="n">sudo</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">ceph</span><span class="o">-</span><span class="n">radosgw</span> <span class="n">start</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="usage-logging">
<h2>Usage Logging<a class="headerlink" href="#usage-logging" title="Permalink to this heading">¶</a></h2>
<p><strong class="program">radosgw</strong> maintains an asynchronous usage log. It accumulates
statistics about user operations and flushes it periodically. The
logs can be accessed and managed through <strong class="program">radosgw-admin</strong>.</p>
<p>The information that is being logged contains total data transfer,
total operations, and total successful operations. The data is being
accounted in an hourly resolution under the bucket owner, unless the
operation was done on the service (e.g., when listing a bucket) in
which case it is accounted under the operating user.</p>
<p>Following is an example configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">radosgw</span><span class="o">.</span><span class="n">gateway</span><span class="p">]</span>
    <span class="n">rgw</span> <span class="n">enable</span> <span class="n">usage</span> <span class="n">log</span> <span class="o">=</span> <span class="n">true</span>
    <span class="n">rgw</span> <span class="n">usage</span> <span class="n">log</span> <span class="n">tick</span> <span class="n">interval</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">rgw</span> <span class="n">usage</span> <span class="n">log</span> <span class="n">flush</span> <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1024</span>
    <span class="n">rgw</span> <span class="n">usage</span> <span class="nb">max</span> <span class="n">shards</span> <span class="o">=</span> <span class="mi">32</span>
    <span class="n">rgw</span> <span class="n">usage</span> <span class="nb">max</span> <span class="n">user</span> <span class="n">shards</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The total number of shards determines how many total objects hold the
usage log information. The per-user number of shards specify how many
objects hold usage information for a single user. The tick interval
configures the number of seconds between log flushes, and the flush
threshold specify how many entries can be kept before resorting to
synchronous flush.</p>
</section>
<section id="availability">
<h2>Availability<a class="headerlink" href="#availability" title="Permalink to this heading">¶</a></h2>
<p><strong class="program">radosgw</strong> is part of Ceph, a massively scalable, open-source, distributed
storage system. Please refer to the Ceph documentation at <a class="reference external" href="http://ceph.com/docs">http://ceph.com/docs</a> for
more information.</p>
</section>
<section id="see-also">
<h2>See also<a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h2>
<p><a class="reference internal" href="../ceph/"><span class="doc">ceph</span></a>(8)
<a class="reference internal" href="../radosgw-admin/"><span class="doc">radosgw-admin</span></a>(8)</p>
</section>
</section>



            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../">
              <img class="logo" src="../../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../start/intro/">Intro to Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/">Installing Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cephadm/">Cephadm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rados/">Ceph Storage Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cephfs/">Ceph File System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rbd/">Ceph Block Device</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../radosgw/">Ceph Object Gateway</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/frontends/">HTTP Frontends</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/placement/">Pool Placement and Storage Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/multisite/">Multisite Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/multisite-sync-policy/">Multisite Sync Policy Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/pools/">Configuring Pools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/config-ref/">Config Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/admin/">Admin Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/s3/">S3 API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/rgw-cache/">Data caching and CDN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/swift/">Swift API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/adminops/">Admin Ops API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/api/">Python binding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/nfs/">Export over NFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/keystone/">OpenStack Keystone Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/barbican/">OpenStack Barbican Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/vault/">HashiCorp Vault Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/kmip/">KMIP Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/opa/">Open Policy Agent Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/multitenancy/">Multi-tenancy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/compression/">Compression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/ldap-auth/">LDAP Authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/encryption/">Server-Side Encryption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/bucketpolicy/">Bucket Policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/dynamicresharding/">Dynamic bucket index resharding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/mfa/">Multi factor authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/sync-modules/">Sync Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/notifications/">Bucket Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/layout/">Data Layout in RADOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/STS/">STS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/STSLite/">STS Lite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/keycloak/">Keycloak</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/session-tags/">Session Tags</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/role/">Role</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/orphans/">Orphan List and Associated Tooling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/oidc/">OpenID Connect Provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/troubleshooting/">Troubleshooting</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Manpage radosgw</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#synopsis">Synopsis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#options">Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage-logging">Usage Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#availability">Availability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#see-also">See also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../radosgw-admin/">Manpage radosgw-admin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/qat-accel/">QAT Acceleration for Encryption and Compression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/s3select/">S3-select</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../radosgw/lua-scripting/">Lua Scripting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../mgr/">Ceph Manager Daemon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mgr/dashboard/">Ceph Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture/">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/developer_guide/">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/internals/">Ceph Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../governance/">Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../foundation/">Ceph Foundation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.ceph.com/en/latest/releases/general/">Ceph Releases (general)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.ceph.com/en/latest/releases/">Ceph Releases (index)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security/">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary/">Glossary</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../http-routingtable/" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../radosgw-admin/" title="radosgw-admin – rados REST gateway user administration utility"
             >next</a> |</li>
        <li class="right" >
          <a href="../../../radosgw/troubleshooting/" title="Troubleshooting"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../radosgw/" >Ceph Object Gateway</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">radosgw – rados REST gateway</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Ceph authors and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).
    </div>
  </body>
</html>