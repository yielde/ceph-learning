
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Influx Module &#8212; Ceph Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/ceph.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="Hello World Module" href="../hello/" />
    <link rel="prev" title="Prometheus Module" href="../prometheus/" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../http-routingtable/" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../hello/" title="Hello World Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../prometheus/" title="Prometheus Module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" accesskey="U">Ceph Manager Daemon</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Influx Module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div id="docubetter" align="right" style="padding: 15px; font-weight: bold;">
    <a href="https://pad.ceph.com/p/Report_Documentation_Bugs">Report a Documentation Bug</a>
  </div>

  
  <section id="influx-module">
<h1>Influx Module<a class="headerlink" href="#influx-module" title="Permalink to this heading">¶</a></h1>
<p>The influx module continuously collects and sends time series data to an
influxdb database.</p>
<p>The influx module was introduced in the 13.x <em>Mimic</em> release.</p>
<section id="enabling">
<h2>Enabling<a class="headerlink" href="#enabling" title="Permalink to this heading">¶</a></h2>
<p>To enable the module, use the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mgr</span> <span class="n">module</span> <span class="n">enable</span> <span class="n">influx</span>
</pre></div>
</div>
<p>If you wish to subsequently disable the module, you can use the equivalent
<em>disable</em> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mgr</span> <span class="n">module</span> <span class="n">disable</span> <span class="n">influx</span>
</pre></div>
</div>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading">¶</a></h2>
<p>For the influx module to send statistics to an InfluxDB server, it
is necessary to configure the servers address and some authentication
credentials.</p>
<p>Set configuration values using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">config</span> <span class="nb">set</span> <span class="n">mgr</span> <span class="n">mgr</span><span class="o">/</span><span class="n">influx</span><span class="o">/&lt;</span><span class="n">key</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The most important settings are <code class="docutils literal notranslate"><span class="pre">hostname</span></code>, <code class="docutils literal notranslate"><span class="pre">username</span></code> and <code class="docutils literal notranslate"><span class="pre">password</span></code>.
For example, a typical configuration might look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">config</span> <span class="nb">set</span> <span class="n">mgr</span> <span class="n">mgr</span><span class="o">/</span><span class="n">influx</span><span class="o">/</span><span class="n">hostname</span> <span class="n">influx</span><span class="o">.</span><span class="n">mydomain</span><span class="o">.</span><span class="n">com</span>
<span class="n">ceph</span> <span class="n">config</span> <span class="nb">set</span> <span class="n">mgr</span> <span class="n">mgr</span><span class="o">/</span><span class="n">influx</span><span class="o">/</span><span class="n">username</span> <span class="n">admin123</span>
<span class="n">ceph</span> <span class="n">config</span> <span class="nb">set</span> <span class="n">mgr</span> <span class="n">mgr</span><span class="o">/</span><span class="n">influx</span><span class="o">/</span><span class="n">password</span> <span class="n">p4ssw0rd</span>
</pre></div>
</div>
<p>Additional optional configuration settings are:</p>
<dl class="field-list simple">
<dt class="field-odd">interval</dt>
<dd class="field-odd"><p>Time between reports to InfluxDB.  Default 30 seconds.</p>
</dd>
<dt class="field-even">database</dt>
<dd class="field-even"><p>InfluxDB database name.  Default “ceph”.  You will need to create this database and grant write privileges to the configured username or the username must have admin privileges to create it.</p>
</dd>
<dt class="field-odd">port</dt>
<dd class="field-odd"><p>InfluxDB server port.  Default 8086</p>
</dd>
<dt class="field-even">ssl</dt>
<dd class="field-even"><p>Use https connection for InfluxDB server. Use “true” or “false”. Default false</p>
</dd>
<dt class="field-odd">verify_ssl</dt>
<dd class="field-odd"><p>Verify https cert for InfluxDB server. Use “true” or “false”. Default true</p>
</dd>
<dt class="field-even">threads</dt>
<dd class="field-even"><p>How many worker threads should be spawned for sending data to InfluxDB. Default is 5</p>
</dd>
<dt class="field-odd">batch_size</dt>
<dd class="field-odd"><p>How big batches of data points should be when sending to InfluxDB. Default is 5000</p>
</dd>
</dl>
</section>
<section id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Permalink to this heading">¶</a></h2>
<p>By default, a few debugging statements as well as error statements have been set to print in the log files. Users can add more if necessary.
To make use of the debugging option in the module:</p>
<ul>
<li><p>Add this to the ceph.conf file.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">mgr</span><span class="p">]</span>
    <span class="n">debug_mgr</span> <span class="o">=</span> <span class="mi">20</span>
</pre></div>
</div>
</li>
<li><p>Use this command <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">influx</span> <span class="pre">self-test</span></code>.</p></li>
<li><p>Check the log files. Users may find it easier to filter the log files using <em>mgr[influx]</em>.</p></li>
</ul>
</section>
<section id="interesting-counters">
<h2>Interesting counters<a class="headerlink" href="#interesting-counters" title="Permalink to this heading">¶</a></h2>
<p>The following tables describe a subset of the values output by
this module.</p>
<section id="pools">
<h3>Pools<a class="headerlink" href="#pools" title="Permalink to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Counter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>stored</p></td>
<td><p>Bytes stored in the pool not including copies</p></td>
</tr>
<tr class="row-odd"><td><p>max_avail</p></td>
<td><p>Max available number of bytes in the pool</p></td>
</tr>
<tr class="row-even"><td><p>objects</p></td>
<td><p>Number of objects in the pool</p></td>
</tr>
<tr class="row-odd"><td><p>wr_bytes</p></td>
<td><p>Number of bytes written in the pool</p></td>
</tr>
<tr class="row-even"><td><p>dirty</p></td>
<td><p>Number of bytes dirty in the pool</p></td>
</tr>
<tr class="row-odd"><td><p>rd_bytes</p></td>
<td><p>Number of bytes read in the pool</p></td>
</tr>
<tr class="row-even"><td><p>stored_raw</p></td>
<td><p>Bytes used in pool including copies made</p></td>
</tr>
</tbody>
</table>
</section>
<section id="osds">
<h3>OSDs<a class="headerlink" href="#osds" title="Permalink to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Counter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>op_w</p></td>
<td><p>Client write operations</p></td>
</tr>
<tr class="row-odd"><td><p>op_in_bytes</p></td>
<td><p>Client operations total write size</p></td>
</tr>
<tr class="row-even"><td><p>op_r</p></td>
<td><p>Client read operations</p></td>
</tr>
<tr class="row-odd"><td><p>op_out_bytes</p></td>
<td><p>Client operations total read size</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Counter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>op_wip</p></td>
<td><p>Replication operations currently being processed (primary)</p></td>
</tr>
<tr class="row-odd"><td><p>op_latency</p></td>
<td><p>Latency of client operations (including queue time)</p></td>
</tr>
<tr class="row-even"><td><p>op_process_latency</p></td>
<td><p>Latency of client operations (excluding queue time)</p></td>
</tr>
<tr class="row-odd"><td><p>op_prepare_latency</p></td>
<td><p>Latency of client operations (excluding queue time and wait for finished)</p></td>
</tr>
<tr class="row-even"><td><p>op_r_latency</p></td>
<td><p>Latency of read operation (including queue time)</p></td>
</tr>
<tr class="row-odd"><td><p>op_r_process_latency</p></td>
<td><p>Latency of read operation (excluding queue time)</p></td>
</tr>
<tr class="row-even"><td><p>op_w_in_bytes</p></td>
<td><p>Client data written</p></td>
</tr>
<tr class="row-odd"><td><p>op_w_latency</p></td>
<td><p>Latency of write operation (including queue time)</p></td>
</tr>
<tr class="row-even"><td><p>op_w_process_latency</p></td>
<td><p>Latency of write operation (excluding queue time)</p></td>
</tr>
<tr class="row-odd"><td><p>op_w_prepare_latency</p></td>
<td><p>Latency of write operations (excluding queue time and wait for finished)</p></td>
</tr>
<tr class="row-even"><td><p>op_rw</p></td>
<td><p>Client read-modify-write operations</p></td>
</tr>
<tr class="row-odd"><td><p>op_rw_in_bytes</p></td>
<td><p>Client read-modify-write operations write in</p></td>
</tr>
<tr class="row-even"><td><p>op_rw_out_bytes</p></td>
<td><p>Client read-modify-write operations read out</p></td>
</tr>
<tr class="row-odd"><td><p>op_rw_latency</p></td>
<td><p>Latency of read-modify-write operation (including queue time)</p></td>
</tr>
<tr class="row-even"><td><p>op_rw_process_latency</p></td>
<td><p>Latency of read-modify-write operation (excluding queue time)</p></td>
</tr>
<tr class="row-odd"><td><p>op_rw_prepare_latency</p></td>
<td><p>Latency of read-modify-write operations (excluding queue time
and wait for finished)</p></td>
</tr>
<tr class="row-even"><td><p>op_before_queue_op_lat</p></td>
<td><p>Latency of IO before calling queue (before really queue into ShardedOpWq)
op_before_dequeue_op_lat</p></td>
</tr>
<tr class="row-odd"><td><p>op_before_dequeue_op_lat</p></td>
<td><p>Latency of IO before calling dequeue_op(already dequeued and get PG lock)</p></td>
</tr>
</tbody>
</table>
<p>Latency counters are measured in microseconds unless otherwise specified in the description.</p>
</section>
</section>
</section>



            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/intro/">Intro to Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">Installing Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephadm/">Cephadm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rados/">Ceph Storage Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephfs/">Ceph File System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rbd/">Ceph Block Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../radosgw/">Ceph Object Gateway</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Ceph Manager Daemon</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../administrator/">Installation and Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/">Writing modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../orchestrator_modules/">Writing orchestrator plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dashboard/">Dashboard module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ceph_api/">Ceph RESTful API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alerts/">Alerts module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../diskprediction/">DiskPrediction module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../localpool/">Local pool module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../restful/">RESTful module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zabbix/">Zabbix module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prometheus/">Prometheus module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Influx module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#debugging">Debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interesting-counters">Interesting counters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pools">Pools</a></li>
<li class="toctree-l4"><a class="reference internal" href="#osds">OSDs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../hello/">Hello module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../telegraf/">Telegraf module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../telemetry/">Telemetry module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iostat/">Iostat module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../crash/">Crash module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../insights/">Insights module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../orchestrator/">Orchestrator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rook/">Rook module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mds_autoscaler/">MDS Autoscaler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nfs/">NFS module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli_api/">CLI API Commands module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dashboard/">Ceph Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/developer_guide/">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/internals/">Ceph Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../governance/">Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../foundation/">Ceph Foundation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.ceph.com/en/latest/releases/general/">Ceph Releases (general)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.ceph.com/en/latest/releases/">Ceph Releases (index)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Glossary</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../http-routingtable/" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../hello/" title="Hello World Module"
             >next</a> |</li>
        <li class="right" >
          <a href="../prometheus/" title="Prometheus Module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" >Ceph Manager Daemon</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Influx Module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Ceph authors and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).
    </div>
  </body>
</html>