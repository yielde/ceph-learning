
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>ceph-mgr module developer’s guide &#8212; Ceph Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/ceph.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="ceph-mgr orchestrator modules" href="../orchestrator_modules/" />
    <link rel="prev" title="ceph-mgr administrator’s guide" href="../administrator/" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../http-routingtable/" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../orchestrator_modules/" title="ceph-mgr orchestrator modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../administrator/" title="ceph-mgr administrator’s guide"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" accesskey="U">Ceph Manager Daemon</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">ceph-mgr module developer’s guide</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div id="docubetter" align="right" style="padding: 15px; font-weight: bold;">
    <a href="https://pad.ceph.com/p/Report_Documentation_Bugs">Report a Documentation Bug</a>
  </div>

  
  <section id="ceph-mgr-module-developer-s-guide">
<span id="mgr-module-dev"></span><h1>ceph-mgr module developer’s guide<a class="headerlink" href="#ceph-mgr-module-developer-s-guide" title="Permalink to this heading">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is developer documentation, describing Ceph internals that
are only relevant to people writing ceph-mgr modules.</p>
</div>
<section id="creating-a-module">
<h2>Creating a module<a class="headerlink" href="#creating-a-module" title="Permalink to this heading">¶</a></h2>
<p>In pybind/mgr/, create a python module.  Within your module, create a class
that inherits from <code class="docutils literal notranslate"><span class="pre">MgrModule</span></code>.  For ceph-mgr to detect your module, your
directory must contain a file called <cite>module.py</cite>.</p>
<p>The most important methods to override are:</p>
<ul class="simple">
<li><p>a <code class="docutils literal notranslate"><span class="pre">serve</span></code> member function for server-type modules.  This
function should block forever.</p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">notify</span></code> member function if your module needs to
take action when new cluster data is available.</p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">handle_command</span></code> member function if your module
exposes CLI commands.</p></li>
</ul>
<p>Some modules interface with external orchestrators to deploy
Ceph services.  These also inherit from <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, which adds
additional methods to the base <code class="docutils literal notranslate"><span class="pre">MgrModule</span></code> class.  See
<a class="reference internal" href="../orchestrator_modules/#orchestrator-modules"><span class="std std-ref">Orchestrator modules</span></a> for more on
creating these modules.</p>
</section>
<section id="installing-a-module">
<h2>Installing a module<a class="headerlink" href="#installing-a-module" title="Permalink to this heading">¶</a></h2>
<p>Once your module is present in the location set by the
<code class="docutils literal notranslate"><span class="pre">mgr</span> <span class="pre">module</span> <span class="pre">path</span></code> configuration setting, you can enable it
via the <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">mgr</span> <span class="pre">module</span> <span class="pre">enable</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mgr</span> <span class="n">module</span> <span class="n">enable</span> <span class="n">mymodule</span>
</pre></div>
</div>
<p>Note that the MgrModule interface is not stable, so any modules maintained
outside of the Ceph tree are liable to break when run against any newer
or older versions of Ceph.</p>
</section>
<section id="logging">
<h2>Logging<a class="headerlink" href="#logging" title="Permalink to this heading">¶</a></h2>
<p>Logging in Ceph manager modules is done as in any other Python program. Just
import the <code class="docutils literal notranslate"><span class="pre">logging</span></code> package and get a logger instance with the
<code class="docutils literal notranslate"><span class="pre">logging.getLogger</span></code> function.</p>
<p>Each module has a <code class="docutils literal notranslate"><span class="pre">log_level</span></code> option that specifies the current Python
logging level of the module.
To change or query the logging level of the module use the following Ceph
commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">config</span> <span class="n">get</span> <span class="n">mgr</span> <span class="n">mgr</span><span class="o">/&lt;</span><span class="n">module_name</span><span class="o">&gt;/</span><span class="n">log_level</span>
<span class="n">ceph</span> <span class="n">config</span> <span class="nb">set</span> <span class="n">mgr</span> <span class="n">mgr</span><span class="o">/&lt;</span><span class="n">module_name</span><span class="o">&gt;/</span><span class="n">log_level</span> <span class="o">&lt;</span><span class="n">info</span><span class="o">|</span><span class="n">debug</span><span class="o">|</span><span class="n">critical</span><span class="o">|</span><span class="n">error</span><span class="o">|</span><span class="n">warning</span><span class="o">|&gt;</span>
</pre></div>
</div>
<p>The logging level used upon the module’s start is determined by the current
logging level of the mgr daemon, unless if the <code class="docutils literal notranslate"><span class="pre">log_level</span></code> option was
previously set with the <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">set</span> <span class="pre">...</span></code> command. The mgr daemon logging
level is mapped to the module python logging level as follows:</p>
<ul class="simple">
<li><p>&lt;= 0 is CRITICAL</p></li>
<li><p>&lt;= 1 is WARNING</p></li>
<li><p>&lt;= 4 is INFO</p></li>
<li><p>&lt;= +inf is DEBUG</p></li>
</ul>
<p>We can unset the module log level and fallback to the mgr daemon logging level
by running the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">config</span> <span class="nb">set</span> <span class="n">mgr</span> <span class="n">mgr</span><span class="o">/&lt;</span><span class="n">module_name</span><span class="o">&gt;/</span><span class="n">log_level</span> <span class="s1">&#39;&#39;</span>
</pre></div>
</div>
<p>By default, modules’ logging messages are processed by the Ceph logging layer
where they will be recorded in the mgr daemon’s log file.
But it’s also possible to send a module’s logging message to it’s own file.</p>
<p>The module’s log file will be located in the same directory as the mgr daemon’s
log file with the following name pattern:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">mgr_daemon_log_file_name</span><span class="o">&gt;.&lt;</span><span class="n">module_name</span><span class="o">&gt;.</span><span class="n">log</span>
</pre></div>
</div>
<p>To enable the file logging on a module use the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">config</span> <span class="nb">set</span> <span class="n">mgr</span> <span class="n">mgr</span><span class="o">/&lt;</span><span class="n">module_name</span><span class="o">&gt;/</span><span class="n">log_to_file</span> <span class="n">true</span>
</pre></div>
</div>
<p>When the module’s file logging is enabled, module’s logging messages stop
being written to the mgr daemon’s log file and are only written to the
module’s log file.</p>
<p>It’s also possible to check the status and disable the file logging with the
following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">config</span> <span class="n">get</span> <span class="n">mgr</span> <span class="n">mgr</span><span class="o">/&lt;</span><span class="n">module_name</span><span class="o">&gt;/</span><span class="n">log_to_file</span>
<span class="n">ceph</span> <span class="n">config</span> <span class="nb">set</span> <span class="n">mgr</span> <span class="n">mgr</span><span class="o">/&lt;</span><span class="n">module_name</span><span class="o">&gt;/</span><span class="n">log_to_file</span> <span class="n">false</span>
</pre></div>
</div>
</section>
<section id="exposing-commands">
<h2>Exposing commands<a class="headerlink" href="#exposing-commands" title="Permalink to this heading">¶</a></h2>
<p>There are two approaches for exposing a command. The first one is to
use the <code class="docutils literal notranslate"><span class="pre">&#64;CLICommand</span></code> decorator to decorate the method which handles
the command. like this</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@CLICommand</span><span class="p">(</span><span class="s1">&#39;antigravity send to blackhole&#39;</span><span class="p">,</span>
            <span class="n">perm</span><span class="o">=</span><span class="s1">&#39;rw&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">send_to_blackhole</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">blackhole</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">inbuf</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Send the specified object to black hole</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_object</span><span class="p">(</span><span class="n">oid</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HandleCommandResult</span><span class="p">(</span><span class="o">-</span><span class="n">errno</span><span class="o">.</span><span class="n">ENOENT</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;object &#39;</span><span class="si">{</span><span class="n">oid</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">blackhole</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">inbuf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">blackhole</span><span class="p">,</span> <span class="n">passphrase</span><span class="o">=</span><span class="n">inbuf</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">HandleCommandResult</span><span class="p">(</span><span class="o">-</span><span class="n">errno</span><span class="o">.</span><span class="n">EINVAL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="s1">&#39;unable to decrypt location&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">blackhole</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">send_object_to</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HandleCommandResult</span><span class="p">(</span><span class="n">stdout</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;the black hole swallowed &#39;</span><span class="p">{</span><span class="n">oid</span><span class="p">}</span><span class="s1">&#39;&quot;)</span>
</pre></div>
</div>
<p>The first parameter passed to <code class="docutils literal notranslate"><span class="pre">CLICommand</span></code> is the “name” of the command.
Since there are lots of commands in Ceph, we tend to group related commands
with a common prefix. In this case, “antigravity” is used for this purpose.
As the author is probably designing a module which is also able to launch
rockets into the deep space.</p>
<p>The <a class="reference external" href="https://www.python.org/dev/peps/pep-0484/">type annotations</a> for the
method parameters are mandatory here, so the usage of the command can be
properly reported to the <code class="docutils literal notranslate"><span class="pre">ceph</span></code> CLI, and the manager daemon can convert
the serialized command parameters sent by the clients to the expected type
before passing them to the handler method. With properly implemented types,
one can also perform some sanity checks against the parameters!</p>
<p>The names of the parameters are part of the command interface, so please
try to take the backward compatibility into consideration when changing
them. But you <strong>cannot</strong> change name of <code class="docutils literal notranslate"><span class="pre">inbuf</span></code> parameter, it is used
to pass the content of the file specified by <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">--in-file</span></code> option.</p>
<p>The docstring of the method is used for the description of the command.</p>
<p>The manager daemon cooks the usage of the command from these ingredients,
like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">antigravity</span> <span class="n">send</span> <span class="n">to</span> <span class="n">blackhole</span> <span class="o">&lt;</span><span class="n">oid</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">blackhole</span><span class="o">&gt;</span><span class="p">]</span>  <span class="n">Send</span> <span class="n">the</span> <span class="n">specified</span> <span class="nb">object</span> <span class="n">to</span> <span class="n">black</span> <span class="n">hole</span>
</pre></div>
</div>
<p>as part of the output of <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">--help</span></code>.</p>
<p>In addition to <code class="docutils literal notranslate"><span class="pre">&#64;CLICommand</span></code>, you could also use <code class="docutils literal notranslate"><span class="pre">&#64;CLIReadCommand</span></code> or
<code class="docutils literal notranslate"><span class="pre">&#64;CLIWriteCommand</span></code> if your command only requires read permissions or
write permissions respectively.</p>
<p>The second one is to set the <code class="docutils literal notranslate"><span class="pre">COMMANDS</span></code> class attribute of your module to
a list of dicts like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">COMMANDS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;cmd&quot;</span><span class="p">:</span> <span class="s2">&quot;foobar name=myarg,type=CephString&quot;</span><span class="p">,</span>
        <span class="s2">&quot;desc&quot;</span><span class="p">:</span> <span class="s2">&quot;Do something awesome&quot;</span><span class="p">,</span>
        <span class="s2">&quot;perm&quot;</span><span class="p">:</span> <span class="s2">&quot;rw&quot;</span><span class="p">,</span>
        <span class="c1"># optional:</span>
        <span class="s2">&quot;poll&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">cmd</span></code> part of each entry is parsed in the same way as internal
Ceph mon and admin socket commands (see mon/MonCommands.h in
the Ceph source for examples). Note that the “poll” field is optional,
and is set to False by default; this indicates to the <code class="docutils literal notranslate"><span class="pre">ceph</span></code> CLI
that it should call this command repeatedly and output results (see
<code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">-h</span></code> and its <code class="docutils literal notranslate"><span class="pre">--period</span></code> option).</p>
<p>Each command is expected to return a tuple <code class="docutils literal notranslate"><span class="pre">(retval,</span> <span class="pre">stdout,</span> <span class="pre">stderr)</span></code>.
<code class="docutils literal notranslate"><span class="pre">retval</span></code> is an integer representing a libc error code (e.g. EINVAL,
EPERM, or 0 for no error), <code class="docutils literal notranslate"><span class="pre">stdout</span></code> is a string containing any
non-error output, and <code class="docutils literal notranslate"><span class="pre">stderr</span></code> is a string containing any progress or
error explanation output.  Either or both of the two strings may be empty.</p>
<p>Implement the <code class="docutils literal notranslate"><span class="pre">handle_command</span></code> function to respond to the commands
when they are sent:</p>
<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.handle_command">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">handle_command</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inbuf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.handle_command" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by ceph-mgr to request the plugin to handle one
of the commands that it declared in self.COMMANDS</p>
<p>Return a status code, an output buffer, and an
output string.  The output buffer is for data results,
the output string is for informative text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inbuf</strong> (<em>str</em>) – content of any “-i &lt;file&gt;” supplied to ceph cli</p></li>
<li><p><strong>cmd</strong> (<em>dict</em>) – from Ceph’s cmdmap_t</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">HandleCommandResult</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>HandleCommandResult or a 3-tuple of (int, str, str)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="configuration-options">
<h2>Configuration options<a class="headerlink" href="#configuration-options" title="Permalink to this heading">¶</a></h2>
<p>Modules can load and store configuration options using the
<code class="docutils literal notranslate"><span class="pre">set_module_option</span></code> and <code class="docutils literal notranslate"><span class="pre">get_module_option</span></code> methods.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">set_module_option</span></code> and <code class="docutils literal notranslate"><span class="pre">get_module_option</span></code> to
manage user-visible configuration options that are not blobs (like
certificates). If you want to persist module-internal data or
binary configuration data consider using the <a class="reference internal" href="#kv-store">KV store</a>.</p>
</div>
<p>You must declare your available configuration options in the
<code class="docutils literal notranslate"><span class="pre">MODULE_OPTIONS</span></code> class attribute, like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MODULE_OPTIONS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;my_option&quot;</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>If you try to use set_module_option or get_module_option on options not declared
in <code class="docutils literal notranslate"><span class="pre">MODULE_OPTIONS</span></code>, an exception will be raised.</p>
<p>You may choose to provide setter commands in your module to perform
high level validation.  Users can also modify configuration using
the normal <cite>ceph config set</cite> command, where the configuration options
for a mgr module are named like <cite>mgr/&lt;module name&gt;/&lt;option&gt;</cite>.</p>
<p>If a configuration option is different depending on which node the mgr
is running on, then use <em>localized</em> configuration (
<code class="docutils literal notranslate"><span class="pre">get_localized_module_option</span></code>, <code class="docutils literal notranslate"><span class="pre">set_localized_module_option</span></code>).
This may be necessary for options such as what address to listen on.
Localized options may also be set externally with <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">config</span> <span class="pre">set</span></code>,
where they key name is like <code class="docutils literal notranslate"><span class="pre">mgr/&lt;module</span> <span class="pre">name&gt;/&lt;mgr</span> <span class="pre">id&gt;/&lt;option&gt;</span></code></p>
<p>If you need to load and store data (e.g. something larger, binary, or multiline),
use the KV store instead of configuration options (see next section).</p>
<p>Hints for using config options:</p>
<ul class="simple">
<li><p>Reads are fast: ceph-mgr keeps a local in-memory copy, so in many cases
you can just do a get_module_option every time you use a option, rather than
copying it out into a variable.</p></li>
<li><p>Writes block until the value is persisted (i.e. round trip to the monitor),
but reads from another thread will see the new value immediately.</p></li>
<li><p>If a user has used <cite>config set</cite> from the command line, then the new
value will become visible to <cite>get_module_option</cite> immediately, although the
mon-&gt;mgr update is asynchronous, so <cite>config set</cite> will return a fraction
of a second before the new value is visible on the mgr.</p></li>
<li><p>To delete a config value (i.e. revert to default), just pass <code class="docutils literal notranslate"><span class="pre">None</span></code> to
set_module_option.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.get_module_option">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">get_module_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_module_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the value of a persistent configuration setting</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.set_module_option">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">set_module_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.set_module_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the value of a persistent configuration setting</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<em>str</em>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.get_localized_module_option">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">get_localized_module_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_localized_module_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve localized configuration for this ceph-mgr instance</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.set_localized_module_option">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">set_localized_module_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.set_localized_module_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Set localized configuration for this ceph-mgr instance
:param str key:
:param str val:
:rtype: <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>
:return: str</p>
</dd></dl>

</section>
<section id="kv-store">
<h2>KV store<a class="headerlink" href="#kv-store" title="Permalink to this heading">¶</a></h2>
<p>Modules have access to a private (per-module) key value store, which
is implemented using the monitor’s “config-key” commands.  Use
the <code class="docutils literal notranslate"><span class="pre">set_store</span></code> and <code class="docutils literal notranslate"><span class="pre">get_store</span></code> methods to access the KV store from
your module.</p>
<p>The KV store commands work in a similar way to the configuration
commands.  Reads are fast, operating from a local cache.  Writes block
on persistence and do a round trip to the monitor.</p>
<p>This data can be access from outside of ceph-mgr using the
<code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">config-key</span> <span class="pre">[get|set]</span></code> commands.  Key names follow the same
conventions as configuration options.  Note that any values updated
from outside of ceph-mgr will not be seen by running modules until
the next restart.  Users should be discouraged from accessing module KV
data externally – if it is necessary for users to populate data, modules
should provide special commands to set the data via the module.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">get_store_prefix</span></code> function to enumerate keys within
a particular prefix (i.e. all keys starting with a particular substring).</p>
<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.get_store">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">get_store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_store" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a value from this module’s persistent key value store</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.set_store">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">set_store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.set_store" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a value in this module’s persistent key value store.
If val is None, remove key from store</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.get_localized_store">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">get_localized_store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_localized_store" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.set_localized_store">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">set_localized_store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.set_localized_store" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.get_store_prefix">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">get_store_prefix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_prefix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_store_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a dict of KV store keys to values, where the keys
have the given prefix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key_prefix</strong> (<em>str</em>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="accessing-cluster-data">
<h2>Accessing cluster data<a class="headerlink" href="#accessing-cluster-data" title="Permalink to this heading">¶</a></h2>
<p>Modules have access to the in-memory copies of the Ceph cluster’s
state that the mgr maintains.  Accessor functions as exposed
as members of MgrModule.</p>
<p>Calls that access the cluster or daemon state are generally going
from Python into native C++ routines.  There is some overhead to this,
but much less than for example calling into a REST API or calling into
an SQL database.</p>
<p>There are no consistency rules about access to cluster structures or
daemon metadata.  For example, an OSD might exist in OSDMap but
have no metadata, or vice versa.  On a healthy cluster these
will be very rare transient states, but modules should be written
to cope with the possibility.</p>
<p>Note that these accessors must not be called in the modules <code class="docutils literal notranslate"><span class="pre">__init__</span></code>
function. This will result in a circular locking exception.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.get">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the plugin to fetch named cluster-wide objects from ceph-mgr.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_name</strong> (<em>str</em>) – Valid things to fetch are osd_crush_map_text,
osd_map, osd_map_tree, osd_map_crush, config, mon_map, fs_map,
osd_metadata, pg_summary, io_rate, pg_dump, df, osd_stats,
health, mon_status, devices, device &lt;devid&gt;, pg_stats,
pool_stats, pg_ready, osd_ping_times.</p>
</dd>
</dl>
<dl class="simple">
<dt>Note:</dt><dd><p>All these structures have their own JSON representations: experiment
or look at the C++ <code class="docutils literal notranslate"><span class="pre">dump()</span></code> methods to learn about them.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.get_server">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">get_server</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hostname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_server" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the plugin to fetch metadata about a particular hostname from
ceph-mgr.</p>
<p>This is information that ceph-mgr has gleaned from the daemon metadata
reported by daemons running on a particular server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hostname</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – a hostname</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.list_servers">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">list_servers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.list_servers" title="Permalink to this definition">¶</a></dt>
<dd><p>Like <code class="docutils literal notranslate"><span class="pre">get_server</span></code>, but gives information about all servers (i.e. all
unique hostnames that have been mentioned in daemon metadata)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of information about all servers</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.get_metadata">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">get_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">svc_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svc_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch the daemon metadata for a particular service.</p>
<p>ceph-mgr fetches metadata asynchronously, so are windows of time during
addition/removal of services where the metadata is not available to
modules.  <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned if no metadata is available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>svc_type</strong> (<em>str</em>) – service type (e.g., ‘mds’, ‘osd’, ‘mon’)</p></li>
<li><p><strong>svc_id</strong> (<em>str</em>) – service id. convert OSD integer IDs to strings when
calling this</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict, or None if no metadata found</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.get_daemon_status">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">get_daemon_status</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">svc_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svc_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_daemon_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch the latest status for a particular service daemon.</p>
<p>This method may return <code class="docutils literal notranslate"><span class="pre">None</span></code> if no status information is
available, for example because the daemon hasn’t fully started yet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>svc_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – string (e.g., ‘rgw’)</p></li>
<li><p><strong>svc_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – string</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dict, or None if the service is not found</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.get_perf_schema">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">get_perf_schema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">svc_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svc_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_perf_schema" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the plugin to fetch perf counter schema info.
svc_name can be nullptr, as can svc_type, in which case
they are wildcards</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>svc_type</strong> (<em>str</em>) – </p></li>
<li><p><strong>svc_name</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of dicts describing the counters requested</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.get_counter">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">get_counter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">svc_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svc_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_counter" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the plugin to fetch the latest performance counter data for a
particular counter on a particular service.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>svc_type</strong> (<em>str</em>) – </p></li>
<li><p><strong>svc_name</strong> (<em>str</em>) – </p></li>
<li><p><strong>path</strong> (<em>str</em>) – a period-separated concatenation of the subsystem and the
counter name, for example “mds.inodes”.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]]</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dict of counter names to their values. each value is a list of
of two-tuples of (timestamp, value).  This may be empty if no data is
available.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.get_mgr_id">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">get_mgr_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_mgr_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the name of the manager daemon where this plugin
is currently being executed (i.e. the active manager).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.get_daemon_health_metrics">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">get_daemon_health_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_daemon_health_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of health metrics per daemon. This includes SLOW_OPS health metrics
in MON and OSD daemons, and PENDING_CREATING_PGS health metrics for OSDs.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]]]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="exposing-health-checks">
<h2>Exposing health checks<a class="headerlink" href="#exposing-health-checks" title="Permalink to this heading">¶</a></h2>
<p>Modules can raise first class Ceph health checks, which will be reported
in the output of <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">status</span></code> and in other places that report on the
cluster’s health.</p>
<p>If you use <code class="docutils literal notranslate"><span class="pre">set_health_checks</span></code> to report a problem, be sure to call
it again with an empty dict to clear your health check when the problem
goes away.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.set_health_checks">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">set_health_checks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checks</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.set_health_checks" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the module’s current map of health checks.  Argument is a
dict of check names to info, in this form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s1">&#39;CHECK_FOO&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;warning&#39;</span><span class="p">,</span>           <span class="c1"># or &#39;error&#39;</span>
    <span class="s1">&#39;summary&#39;</span><span class="p">:</span> <span class="s1">&#39;summary string&#39;</span><span class="p">,</span>
    <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>                      <span class="c1"># quantify badness</span>
    <span class="s1">&#39;detail&#39;</span><span class="p">:</span> <span class="p">[</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="s1">&#39;of&#39;</span><span class="p">,</span> <span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="s1">&#39;strings&#39;</span> <span class="p">],</span>
   <span class="p">},</span>
  <span class="s1">&#39;CHECK_BAR&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span>
    <span class="s1">&#39;summary&#39;</span><span class="p">:</span> <span class="s1">&#39;bars are bad&#39;</span><span class="p">,</span>
    <span class="s1">&#39;detail&#39;</span><span class="p">:</span> <span class="p">[</span> <span class="s1">&#39;too hard&#39;</span> <span class="p">],</span>
  <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>list</strong> – dict of health check dicts</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="what-if-the-mons-are-down">
<h2>What if the mons are down?<a class="headerlink" href="#what-if-the-mons-are-down" title="Permalink to this heading">¶</a></h2>
<p>The manager daemon gets much of its state (such as the cluster maps)
from the monitor.  If the monitor cluster is inaccessible, whichever
manager was active will continue to run, with the latest state it saw
still in memory.</p>
<p>However, if you are creating a module that shows the cluster state
to the user then you may well not want to mislead them by showing
them that out of date state.</p>
<p>To check if the manager daemon currently has a connection to
the monitor cluster, use this function:</p>
<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.have_mon_connection">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">have_mon_connection</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.have_mon_connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether this ceph-mgr daemon has an open connection
to a monitor.  If it doesn’t, then it’s likely that the
information we have about the cluster is out of date,
and/or the monitor cluster is down.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="reporting-if-your-module-cannot-run">
<h2>Reporting if your module cannot run<a class="headerlink" href="#reporting-if-your-module-cannot-run" title="Permalink to this heading">¶</a></h2>
<p>If your module cannot be run for any reason (such as a missing dependency),
then you can report that by implementing the <code class="docutils literal notranslate"><span class="pre">can_run</span></code> function.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.can_run">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">can_run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.can_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement this function to report whether the module’s dependencies
are met.  For example, if the module needs to import a particular
dependency to work, then use a try/except around the import at
file scope, and then report here if the import failed.</p>
<p>This will be called in a blocking way from the C++ code, so do not
do any I/O that could block in this function.</p>
<p>:return a 2-tuple consisting of a boolean and explanatory string</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
</dl>
</dd></dl>

<p>Note that this will only work properly if your module can always be imported:
if you are importing a dependency that may be absent, then do it in a
try/except block so that your module can be loaded far enough to use
<code class="docutils literal notranslate"><span class="pre">can_run</span></code> even if the dependency is absent.</p>
</section>
<section id="sending-commands">
<h2>Sending commands<a class="headerlink" href="#sending-commands" title="Permalink to this heading">¶</a></h2>
<p>A non-blocking facility is provided for sending monitor commands
to the cluster.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.send_command">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">send_command</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svc_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svc_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">command</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inbuf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.send_command" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the plugin to send a command to the mon
cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>CommandResult</em>) – an instance of the <code class="docutils literal notranslate"><span class="pre">CommandResult</span></code>
class, defined in the same module as MgrModule.  This acts as a
completion and stores the output of the command.  Use
<code class="docutils literal notranslate"><span class="pre">CommandResult.wait()</span></code> if you want to block on completion.</p></li>
<li><p><strong>svc_type</strong> (<em>str</em>) – </p></li>
<li><p><strong>svc_id</strong> (<em>str</em>) – </p></li>
<li><p><strong>command</strong> (<em>str</em>) – a JSON-serialized command.  This uses the same
format as the ceph command line, which is a dictionary of command
arguments, with the extra <code class="docutils literal notranslate"><span class="pre">prefix</span></code> key containing the command
name itself.  Consult MonCommands.h for available commands and
their expected arguments.</p></li>
<li><p><strong>tag</strong> (<em>str</em>) – used for nonblocking operation: when a command
completes, the <code class="docutils literal notranslate"><span class="pre">notify()</span></code> callback on the MgrModule instance is
triggered, with notify_type set to “command”, and notify_id set to
the tag of the command.</p></li>
<li><p><strong>inbuf</strong> (<em>str</em>) – input buffer for sending additional data.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="receiving-notifications">
<h2>Receiving notifications<a class="headerlink" href="#receiving-notifications" title="Permalink to this heading">¶</a></h2>
<p>The manager daemon calls the <code class="docutils literal notranslate"><span class="pre">notify</span></code> function on all active modules
when certain important pieces of cluster state are updated, such as the
cluster maps.</p>
<p>The actual data is not passed into this function, rather it is a cue for
the module to go and read the relevant structure if it is interested.  Most
modules ignore most types of notification: to ignore a notification
simply return from this function without doing anything.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.notify">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">notify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">notify_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notify_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.notify" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the ceph-mgr service to notify the Python plugin
that new state is available.  This method is <em>only</em> called for
notify_types that are listed in the NOTIFY_TYPES string list
member of the module class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>notify_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NotifyType</span></code>) – string indicating what kind of notification,
such as osd_map, mon_map, fs_map, mon_status,
health, pg_summary, command, service_map</p></li>
<li><p><strong>notify_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – string (may be empty) that optionally specifies
which entity is being notified about.  With
“command” notifications this is set to the tag
<code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">send_command</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="accessing-rados-or-cephfs">
<h2>Accessing RADOS or CephFS<a class="headerlink" href="#accessing-rados-or-cephfs" title="Permalink to this heading">¶</a></h2>
<p>If you want to use the librados python API to access data stored in
the Ceph cluster, you can access the <code class="docutils literal notranslate"><span class="pre">rados</span></code> attribute of your
<code class="docutils literal notranslate"><span class="pre">MgrModule</span></code> instance.  This is an instance of <code class="docutils literal notranslate"><span class="pre">rados.Rados</span></code> which
has been constructed for you using the existing Ceph context (an internal
detail of the C++ Ceph code) of the mgr daemon.</p>
<p>Always use this specially constructed librados instance instead of
constructing one by hand.</p>
<p>Similarly, if you are using libcephfs to access the file system, then
use the libcephfs <code class="docutils literal notranslate"><span class="pre">create_with_rados</span></code> to construct it from the
<code class="docutils literal notranslate"><span class="pre">MgrModule.rados</span></code> librados instance, and thereby inherit the correct context.</p>
<p>Remember that your module may be running while other parts of the cluster
are down: do not assume that librados or libcephfs calls will return
promptly – consider whether to use timeouts or to block if the rest of
the cluster is not fully available.</p>
</section>
<section id="implementing-standby-mode">
<h2>Implementing standby mode<a class="headerlink" href="#implementing-standby-mode" title="Permalink to this heading">¶</a></h2>
<p>For some modules, it is useful to run on standby manager daemons as well
as on the active daemon.  For example, an HTTP server can usefully
serve HTTP redirect responses from the standby managers so that
the user can point his browser at any of the manager daemons without
having to worry about which one is active.</p>
<p>Standby manager daemons look for a subclass of <code class="docutils literal notranslate"><span class="pre">StandbyModule</span></code>
in each module.  If the class is not found then the module is not
used at all on standby daemons.  If the class is found, then
its <code class="docutils literal notranslate"><span class="pre">serve</span></code> method is called.  Implementations of <code class="docutils literal notranslate"><span class="pre">StandbyModule</span></code>
must inherit from <code class="docutils literal notranslate"><span class="pre">mgr_module.MgrStandbyModule</span></code>.</p>
<p>The interface of <code class="docutils literal notranslate"><span class="pre">MgrStandbyModule</span></code> is much restricted compared to
<code class="docutils literal notranslate"><span class="pre">MgrModule</span></code> – none of the Ceph cluster state is available to
the module.  <code class="docutils literal notranslate"><span class="pre">serve</span></code> and <code class="docutils literal notranslate"><span class="pre">shutdown</span></code> methods are used in the same
way as a normal module class.  The <code class="docutils literal notranslate"><span class="pre">get_active_uri</span></code> method enables
the standby module to discover the address of its active peer in
order to make redirects.  See the <code class="docutils literal notranslate"><span class="pre">MgrStandbyModule</span></code> definition
in the Ceph source code for the full list of methods.</p>
<p>For an example of how to use this interface, look at the source code
of the <code class="docutils literal notranslate"><span class="pre">dashboard</span></code> module.</p>
</section>
<section id="communicating-between-modules">
<h2>Communicating between modules<a class="headerlink" href="#communicating-between-modules" title="Permalink to this heading">¶</a></h2>
<p>Modules can invoke member functions of other modules.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mgr_module.MgrModule.remote">
<span class="sig-prename descclassname"><span class="pre">MgrModule.</span></span><span class="sig-name descname"><span class="pre">remote</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.remote" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke a method on another module.  All arguments, and the return
value from the other module must be serializable.</p>
<p>Limitation: Do not import any modules within the called method.
Otherwise you will get an error in Python 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;cannot unmarshal code objects in restricted execution mode&#39;</span><span class="p">,)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Name of other module.  If module isn’t loaded,
an ImportError exception is raised.</p></li>
<li><p><strong>method_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Method name.  If it does not exist, a NameError
exception is raised.</p></li>
<li><p><strong>args</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – Argument tuple</p></li>
<li><p><strong>kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>) – Keyword argument dict</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>RuntimeError</strong> – <strong>Any</strong> error raised within the method is converted to a RuntimeError</p></li>
<li><p><strong>ImportError</strong> – No such module</p></li>
</ul>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></p>
</dd>
</dl>
</dd></dl>

<p>Be sure to handle <code class="docutils literal notranslate"><span class="pre">ImportError</span></code> to deal with the case that the desired
module is not enabled.</p>
<p>If the remote method raises a python exception, this will be converted
to a RuntimeError on the calling side, where the message string describes
the exception that was originally thrown.  If your logic intends
to handle certain errors cleanly, it is better to modify the remote method
to return an error value instead of raising an exception.</p>
<p>At time of writing, inter-module calls are implemented without
copies or serialization, so when you return a python object, you’re
returning a reference to that object to the calling module.  It
is recommend <em>not</em> to rely on this reference passing, as in future the
implementation may change to serialize arguments and return
values.</p>
</section>
<section id="shutting-down-cleanly">
<h2>Shutting down cleanly<a class="headerlink" href="#shutting-down-cleanly" title="Permalink to this heading">¶</a></h2>
<p>If a module implements the <code class="docutils literal notranslate"><span class="pre">serve()</span></code> method, it should also implement
the <code class="docutils literal notranslate"><span class="pre">shutdown()</span></code> method to shutdown cleanly: misbehaving modules
may otherwise prevent clean shutdown of ceph-mgr.</p>
</section>
<section id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Permalink to this heading">¶</a></h2>
<p>It is not possible to call back into C++ code from a module’s
<code class="docutils literal notranslate"><span class="pre">__init__()</span></code> method.  For example calling <code class="docutils literal notranslate"><span class="pre">self.get_module_option()</span></code> at
this point will result in an assertion failure in ceph-mgr.  For modules
that implement the <code class="docutils literal notranslate"><span class="pre">serve()</span></code> method, it usually makes sense to do most
initialization inside that method instead.</p>
</section>
<section id="is-something-missing">
<h2>Is something missing?<a class="headerlink" href="#is-something-missing" title="Permalink to this heading">¶</a></h2>
<p>The ceph-mgr python interface is not set in stone.  If you have a need
that is not satisfied by the current interface, please bring it up
on the ceph-devel mailing list.  While it is desired to avoid bloating
the interface, it is not generally very hard to expose existing data
to the Python code when there is a good reason.</p>
</section>
</section>



            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/intro/">Intro to Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">Installing Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephadm/">Cephadm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rados/">Ceph Storage Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephfs/">Ceph File System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rbd/">Ceph Block Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../radosgw/">Ceph Object Gateway</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Ceph Manager Daemon</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../administrator/">Installation and Configuration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Writing modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-module">Creating a module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-a-module">Installing a module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logging">Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exposing-commands">Exposing commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-options">Configuration options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kv-store">KV store</a></li>
<li class="toctree-l3"><a class="reference internal" href="#accessing-cluster-data">Accessing cluster data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exposing-health-checks">Exposing health checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-if-the-mons-are-down">What if the mons are down?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reporting-if-your-module-cannot-run">Reporting if your module cannot run</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sending-commands">Sending commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#receiving-notifications">Receiving notifications</a></li>
<li class="toctree-l3"><a class="reference internal" href="#accessing-rados-or-cephfs">Accessing RADOS or CephFS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementing-standby-mode">Implementing standby mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#communicating-between-modules">Communicating between modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#shutting-down-cleanly">Shutting down cleanly</a></li>
<li class="toctree-l3"><a class="reference internal" href="#limitations">Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#is-something-missing">Is something missing?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../orchestrator_modules/">Writing orchestrator plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dashboard/">Dashboard module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ceph_api/">Ceph RESTful API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alerts/">Alerts module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../diskprediction/">DiskPrediction module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../localpool/">Local pool module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../restful/">RESTful module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zabbix/">Zabbix module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prometheus/">Prometheus module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../influx/">Influx module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hello/">Hello module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../telegraf/">Telegraf module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../telemetry/">Telemetry module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iostat/">Iostat module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../crash/">Crash module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../insights/">Insights module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../orchestrator/">Orchestrator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rook/">Rook module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mds_autoscaler/">MDS Autoscaler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nfs/">NFS module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli_api/">CLI API Commands module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dashboard/">Ceph Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/developer_guide/">Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/internals/">Ceph Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../governance/">Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../foundation/">Ceph Foundation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.ceph.com/en/latest/releases/general/">Ceph Releases (general)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.ceph.com/en/latest/releases/">Ceph Releases (index)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Glossary</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../http-routingtable/" title="HTTP Routing Table"
             >routing table</a> |</li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../orchestrator_modules/" title="ceph-mgr orchestrator modules"
             >next</a> |</li>
        <li class="right" >
          <a href="../administrator/" title="ceph-mgr administrator’s guide"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" >Ceph Manager Daemon</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">ceph-mgr module developer’s guide</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Ceph authors and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).
    </div>
  </body>
</html>